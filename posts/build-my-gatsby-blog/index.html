<!DOCTYPE html><html><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><meta name="generator" content="Gatsby 5.14.1"/><meta name="theme-color" content="#438579"/><meta name="description" content="Homepage and blog of Lolipop, share knowledge about software / frontend development." data-gatsby-head="true"/><style data-href="/styles.3c390c6c8d86a13ee344.css" data-identity="gatsby-global-css">@import url(https://unpkg.com/prismjs@1.29.0/themes/prism-tomorrow.min.css);@import url(https://unpkg.com/@fancyapps/ui@5.0.36/dist/fancybox/fancybox.css);@import url(https://unpkg.com/gitalk@1.8.0/dist/gitalk.css);@import url(https://unpkg.com/github-markdown-css@5.8.1/github-markdown-dark.css);@import url(https://unpkg.com/heti@0.9.5/umd/heti.min.css);#nprogress{pointer-events:none}#nprogress .bar{background:var(--primary);height:2px;left:0;position:fixed;top:0;width:100%;z-index:1031}#nprogress .peg{box-shadow:0 0 10px var(--primary),0 0 5px var(--primary);display:block;height:100%;opacity:1;position:absolute;right:0;-webkit-transform:rotate(3deg) translateY(-4px);-ms-transform:rotate(3deg) translateY(-4px);transform:rotate(3deg) translateY(-4px);width:100px}#nprogress .spinner{display:block;position:fixed;right:15px;top:15px;z-index:1031}#nprogress .spinner-icon{-webkit-animation:nprogress-spinner .4s linear infinite;animation:nprogress-spinner .4s linear infinite;border-bottom:2px solid transparent;border-left:2px solid transparent;border-left-color:var(--primary);border-radius:50%;border-right:2px solid transparent;border-top:2px solid transparent;border-top-color:var(--primary);box-sizing:border-box;height:18px;width:18px}.nprogress-custom-parent{overflow:hidden;position:relative}.nprogress-custom-parent #nprogress .bar,.nprogress-custom-parent #nprogress .spinner{position:absolute}@-webkit-keyframes nprogress-spinner{0%{-webkit-transform:rotate(0deg)}to{-webkit-transform:rotate(1turn)}}@keyframes nprogress-spinner{0%{transform:rotate(0deg)}to{transform:rotate(1turn)}}*,:after,:before{--tw-border-spacing-x:0;--tw-border-spacing-y:0;--tw-translate-x:0;--tw-translate-y:0;--tw-rotate:0;--tw-skew-x:0;--tw-skew-y:0;--tw-scale-x:1;--tw-scale-y:1;--tw-pan-x: ;--tw-pan-y: ;--tw-pinch-zoom: ;--tw-scroll-snap-strictness:proximity;--tw-gradient-from-position: ;--tw-gradient-via-position: ;--tw-gradient-to-position: ;--tw-ordinal: ;--tw-slashed-zero: ;--tw-numeric-figure: ;--tw-numeric-spacing: ;--tw-numeric-fraction: ;--tw-ring-inset: ;--tw-ring-offset-width:0px;--tw-ring-offset-color:#fff;--tw-ring-color:rgba(59,130,246,.5);--tw-ring-offset-shadow:0 0 #0000;--tw-ring-shadow:0 0 #0000;--tw-shadow:0 0 #0000;--tw-shadow-colored:0 0 #0000;--tw-blur: ;--tw-brightness: ;--tw-contrast: ;--tw-grayscale: ;--tw-hue-rotate: ;--tw-invert: ;--tw-saturate: ;--tw-sepia: ;--tw-drop-shadow: ;--tw-backdrop-blur: ;--tw-backdrop-brightness: ;--tw-backdrop-contrast: ;--tw-backdrop-grayscale: ;--tw-backdrop-hue-rotate: ;--tw-backdrop-invert: ;--tw-backdrop-opacity: ;--tw-backdrop-saturate: ;--tw-backdrop-sepia: ;--tw-contain-size: ;--tw-contain-layout: ;--tw-contain-paint: ;--tw-contain-style: }::backdrop{--tw-border-spacing-x:0;--tw-border-spacing-y:0;--tw-translate-x:0;--tw-translate-y:0;--tw-rotate:0;--tw-skew-x:0;--tw-skew-y:0;--tw-scale-x:1;--tw-scale-y:1;--tw-pan-x: ;--tw-pan-y: ;--tw-pinch-zoom: ;--tw-scroll-snap-strictness:proximity;--tw-gradient-from-position: ;--tw-gradient-via-position: ;--tw-gradient-to-position: ;--tw-ordinal: ;--tw-slashed-zero: ;--tw-numeric-figure: ;--tw-numeric-spacing: ;--tw-numeric-fraction: ;--tw-ring-inset: ;--tw-ring-offset-width:0px;--tw-ring-offset-color:#fff;--tw-ring-color:rgba(59,130,246,.5);--tw-ring-offset-shadow:0 0 #0000;--tw-ring-shadow:0 0 #0000;--tw-shadow:0 0 #0000;--tw-shadow-colored:0 0 #0000;--tw-blur: ;--tw-brightness: ;--tw-contrast: ;--tw-grayscale: ;--tw-hue-rotate: ;--tw-invert: ;--tw-saturate: ;--tw-sepia: ;--tw-drop-shadow: ;--tw-backdrop-blur: ;--tw-backdrop-brightness: ;--tw-backdrop-contrast: ;--tw-backdrop-grayscale: ;--tw-backdrop-hue-rotate: ;--tw-backdrop-invert: ;--tw-backdrop-opacity: ;--tw-backdrop-saturate: ;--tw-backdrop-sepia: ;--tw-contain-size: ;--tw-contain-layout: ;--tw-contain-paint: ;--tw-contain-style: }

/*
! tailwindcss v3.4.17 | MIT License | https://tailwindcss.com
*/*,:after,:before{border:0 solid #e5e7eb;box-sizing:border-box}:after,:before{--tw-content:""}:host,html{-webkit-text-size-adjust:100%;font-feature-settings:normal;-webkit-tap-highlight-color:transparent;font-family:ui-sans-serif,system-ui,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol,Noto Color Emoji;font-variation-settings:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4}body{line-height:inherit;margin:0}hr{border-top-width:1px;color:inherit;height:0}abbr:where([title]){-webkit-text-decoration:underline dotted;text-decoration:underline dotted}h1,h2,h3,h4,h5,h6{font-size:inherit;font-weight:inherit}a{color:inherit;text-decoration:inherit}b,strong{font-weight:bolder}code,kbd,pre,samp{font-feature-settings:normal;font-family:ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,Liberation Mono,Courier New,monospace;font-size:1em;font-variation-settings:normal}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}table{border-collapse:collapse;border-color:inherit;text-indent:0}button,input,optgroup,select,textarea{font-feature-settings:inherit;color:inherit;font-family:inherit;font-size:100%;font-variation-settings:inherit;font-weight:inherit;letter-spacing:inherit;line-height:inherit;margin:0;padding:0}button,select{text-transform:none}button,input:where([type=button]),input:where([type=reset]),input:where([type=submit]){-webkit-appearance:button;background-color:transparent;background-image:none}:-moz-focusring{outline:auto}:-moz-ui-invalid{box-shadow:none}progress{vertical-align:baseline}::-webkit-inner-spin-button,::-webkit-outer-spin-button{height:auto}[type=search]{-webkit-appearance:textfield;outline-offset:-2px}::-webkit-search-decoration{-webkit-appearance:none}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}summary{display:list-item}blockquote,dd,dl,figure,h1,h2,h3,h4,h5,h6,hr,p,pre{margin:0}fieldset{margin:0}fieldset,legend{padding:0}menu,ol,ul{list-style:none;margin:0;padding:0}dialog{padding:0}textarea{resize:vertical}input::-moz-placeholder,textarea::-moz-placeholder{color:#9ca3af;opacity:1}input::placeholder,textarea::placeholder{color:#9ca3af;opacity:1}[role=button],button{cursor:pointer}:disabled{cursor:default}audio,canvas,embed,iframe,img,object,svg,video{display:block;vertical-align:middle}img,video{height:auto;max-width:100%}[hidden]:where(:not([hidden=until-found])){display:none}:root{--height-header:4rem;--height-footer:14rem;--primary:#61bfad;--primary-light:#80cbbd;--primary-dark:#438579;--foreground:#f5f5f5;--foreground-secondary:#a3a3a3;--foreground-tertiary:rgba(82,82,82,.8);--background:#171717;--background-light:#1c1c1c;--background-lighter:#212121;--background-dark:#111;--background-darker:#0a0a0a}::-moz-selection{background-color:var(--primary-dark)}::selection{background-color:var(--primary-dark)}::-webkit-scrollbar{height:.75rem;width:.75rem}::-webkit-scrollbar-track{--tw-bg-opacity:1;background-color:rgb(64 64 64/var(--tw-bg-opacity,1))}::-webkit-scrollbar-thumb{--tw-bg-opacity:1;background-color:rgb(82 82 82/var(--tw-bg-opacity,1));border-radius:.375rem}::-webkit-scrollbar-thumb:hover{--tw-bg-opacity:1;background-color:rgb(115 115 115/var(--tw-bg-opacity,1))}html{font-family:-apple-system,BlinkMacSystemFont,Helvetica Neue,Arial,PingFang SC,Hiragino Sans GB,STHeiti,Microsoft YaHei,Microsoft JhengHei,Source Han Sans SC,Noto Sans CJK SC,Source Han Sans CN,Noto Sans SC,Source Han Sans TC,Noto Sans CJK TC,WenQuanYi Micro Hei,SimSun,sans-serif}body{background-color:var(--background);color:var(--foreground)}.item-selectable{cursor:pointer;transition-duration:.15s;transition-property:color,background-color,border-color,text-decoration-color,fill,stroke;transition-timing-function:cubic-bezier(.4,0,.2,1)}.item-selectable:hover{background-color:rgba(82,82,82,.3)}.item-selected{background-color:rgba(82,82,82,.5)!important;transition-duration:.15s;transition-property:color,background-color,border-color,text-decoration-color,fill,stroke;transition-timing-function:cubic-bezier(.4,0,.2,1)}.item-secondary{color:var(--foreground-secondary)}.item-secondary.item-selectable{transition-duration:.15s;transition-property:color,background-color,border-color,text-decoration-color,fill,stroke;transition-timing-function:cubic-bezier(.4,0,.2,1)}.item-secondary.item-selectable:hover{background-color:inherit;color:var(--foreground)}.item-converse-color{background-color:var(--foreground);color:var(--background)}.item-converse-color.item-selectable{transition-duration:.15s;transition-property:color,background-color,border-color,text-decoration-color,fill,stroke;transition-timing-function:cubic-bezier(.4,0,.2,1)}.item-converse-color.item-selectable:hover{background-color:var(--foreground-secondary);color:var(--background-darker)}.item-link{color:var(--primary-light)}.item-link:hover{border-style:none;color:var(--primary);text-decoration-line:underline;text-decoration-style:wavy;text-decoration-thickness:2px;text-underline-offset:2px}.post-entry blockquote,.post-entry iframe,.post-entry img,.post-entry pre,.post-entry video{border-radius:.5rem}.post-entry blockquote{border-color:var(--primary);border-left-width:4px;margin-inline-end:0;margin-inline-start:0}:is(.post-entry blockquote) :last-child{margin-bottom:.75rem}.post-entry>a>img,.post-entry>a>video,.post-entry>iframe,.post-entry>img,.post-entry>span.gatsby-resp-image-wrapper,.post-entry>span>span.gatsby-resp-image-wrapper,.post-entry>table,.post-entry>video{margin-bottom:1.5rem;margin-left:-1.5rem!important;margin-right:-1.5rem!important;margin-top:.75rem;max-width:none;width:calc(100% + 3rem)}.post-entry img.gatsby-resp-image-image{box-shadow:var(--background-light) 0 0 0 400px inset!important}.post-entry a{color:var(--primary-light)}.post-entry a:hover{border-style:none;color:var(--primary);text-decoration-line:underline;text-decoration-style:wavy;text-decoration-thickness:2px;text-underline-offset:2px}.gatsby-resp-image-link:is(.post-entry a):hover{padding-bottom:0}.post-entry code{word-break:break-all}.post-entry pre{margin-bottom:1.5rem;margin-top:1.5rem}.post-entry h1,.post-entry h2,.post-entry h3,.post-entry h4,.post-entry h5,.post-entry h6{scroll-margin-top:4rem}:is(.gitalk .gt-container) a{color:var(--primary)}:is(.gitalk .gt-container) a:hover{color:var(--primary-light)}:is(.gitalk .gt-container) .gt-btn-login,:is(.gitalk .gt-container) .gt-btn-public{background-color:var(--primary-dark);border-color:var(--primary-dark);color:var(--foreground);transition-duration:.15s;transition-property:color,background-color,border-color,text-decoration-color,fill,stroke,opacity,box-shadow,transform,filter,-webkit-backdrop-filter;transition-property:color,background-color,border-color,text-decoration-color,fill,stroke,opacity,box-shadow,transform,filter,backdrop-filter;transition-property:color,background-color,border-color,text-decoration-color,fill,stroke,opacity,box-shadow,transform,filter,backdrop-filter,-webkit-backdrop-filter;transition-timing-function:cubic-bezier(.4,0,.2,1)}:is(.gitalk .gt-container) .gt-btn-login:hover,:is(.gitalk .gt-container) .gt-btn-public:hover{background-color:var(--primary)}:is(:is(.gitalk .gt-container) .gt-no-init) p{margin-bottom:.5rem}:is(.gitalk .gt-container) .gt-meta{border-bottom-color:var(--foreground-tertiary);z-index:10}:is(:is(.gitalk .gt-container) .gt-meta) .gt-popup{background-color:var(--background-lighter)}:is(:is(:is(.gitalk .gt-container) .gt-header) .gt-avatar-github) .gt-ico-github svg{fill:var(--foreground)}:is(:is(:is(.gitalk .gt-container) .gt-header) .gt-header-comment) .gt-header-preview,:is(:is(:is(.gitalk .gt-container) .gt-header) .gt-header-comment) .gt-header-textarea{background-color:var(--background-lighter);min-height:6rem}:is(:is(:is(:is(:is(:is(.gitalk .gt-container) .gt-header) .gt-header-comment) .gt-header-controls) .gt-header-controls-tip) .gt-ico-tip) svg{fill:var(--primary)}:is(:is(:is(:is(.gitalk .gt-container) .gt-header) .gt-header-comment) .gt-header-controls) .gt-btn-preview{background-color:var(--background-light);border-color:var(--primary);color:var(--primary);transition-duration:.15s;transition-property:color,background-color,border-color,text-decoration-color,fill,stroke,opacity,box-shadow,transform,filter,-webkit-backdrop-filter;transition-property:color,background-color,border-color,text-decoration-color,fill,stroke,opacity,box-shadow,transform,filter,backdrop-filter;transition-property:color,background-color,border-color,text-decoration-color,fill,stroke,opacity,box-shadow,transform,filter,backdrop-filter,-webkit-backdrop-filter;transition-timing-function:cubic-bezier(.4,0,.2,1)}:is(:is(:is(:is(.gitalk .gt-container) .gt-header) .gt-header-comment) .gt-header-controls) .gt-btn-preview:hover{background-color:var(--background-lighter);border-color:var(--primary-light);color:var(--primary-light)}:is(:is(:is(.gitalk .gt-container) .gt-comments) .gt-comment) .gt-comment-content{background-color:var(--background-lighter)}:is(:is(:is(.gitalk .gt-container) .gt-comments) .gt-comment) .gt-comment-content:hover{--tw-shadow:0 0 #0000;--tw-shadow-colored:0 0 #0000;box-shadow:var(--tw-ring-offset-shadow,0 0 #0000),var(--tw-ring-shadow,0 0 #0000),var(--tw-shadow)}:is(:is(:is(:is(:is(:is(.gitalk .gt-container) .gt-comments) .gt-comment) .gt-comment-content) .gt-comment-header) .gt-comment-like,:is(:is(:is(:is(:is(.gitalk .gt-container) .gt-comments) .gt-comment) .gt-comment-content) .gt-comment-header) .gt-comment-edit,:is(:is(:is(:is(:is(.gitalk .gt-container) .gt-comments) .gt-comment) .gt-comment-content) .gt-comment-header) .gt-comment-reply) svg{fill:var(--primary)}:is(:is(:is(:is(:is(:is(.gitalk .gt-container) .gt-comments) .gt-comment) .gt-comment-content) .gt-comment-header) .gt-comment-like,:is(:is(:is(:is(:is(.gitalk .gt-container) .gt-comments) .gt-comment) .gt-comment-content) .gt-comment-header) .gt-comment-edit,:is(:is(:is(:is(:is(.gitalk .gt-container) .gt-comments) .gt-comment) .gt-comment-content) .gt-comment-header) .gt-comment-reply) svg:hover{fill:var(--primary-light)}:is(:is(:is(:is(.gitalk .gt-container) .gt-comments) .gt-comment) .gt-comment-content) .gt-comment-body{--tw-text-opacity:1!important;background-color:inherit;color:rgb(240 246 252/var(--tw-text-opacity,1))!important}:is(:is(.gitalk .gt-container) .markdown-body) a{color:var(--primary-light)}:is(:is(.gitalk .gt-container) .markdown-body) a:hover{border-style:none;color:var(--primary);text-decoration-line:underline;text-decoration-style:wavy;text-decoration-thickness:2px;text-underline-offset:2px}.algolia-search-box{border-bottom-width:1px;border-color:var(--foreground-tertiary);color:var(--foreground);padding:.75rem 1.5rem}@media (min-width:640px){.algolia-search-box{padding-bottom:1rem;padding-top:1rem}}.algolia-search-box>form{display:flex;flex-wrap:wrap;gap:.5rem;width:100%}:is(.algolia-search-box>form)>input{background-color:rgba(64,64,64,.8);border-radius:.5rem;flex:1 1 0%;font-size:1rem;line-height:1.5rem;max-width:100%;padding:.25rem .5rem}@media (min-width:640px){:is(.algolia-search-box>form)>input{font-size:1.125rem;line-height:1.75rem;padding:.375rem .75rem}}:is(.algolia-search-box>form) svg{fill:currentColor;height:1rem;width:1rem}@media (min-width:640px){:is(.algolia-search-box>form) svg{height:1.25rem;width:1.25rem}}:is(.algolia-search-box>form) button{cursor:pointer;transition-duration:.15s;transition-property:color,background-color,border-color,text-decoration-color,fill,stroke;transition-timing-function:cubic-bezier(.4,0,.2,1)}:is(.algolia-search-box>form) button:hover{background-color:rgba(82,82,82,.3)}.item-secondary:is(.algolia-search-box>form) button{transition-duration:.15s;transition-property:color,background-color,border-color,text-decoration-color,fill,stroke;transition-timing-function:cubic-bezier(.4,0,.2,1)}.item-secondary:is(.algolia-search-box>form) button:hover{background-color:inherit;color:var(--foreground)}.item-converse-color:is(.algolia-search-box>form) button{transition-duration:.15s;transition-property:color,background-color,border-color,text-decoration-color,fill,stroke;transition-timing-function:cubic-bezier(.4,0,.2,1)}.item-converse-color:is(.algolia-search-box>form) button:hover{background-color:var(--foreground-secondary);color:var(--background-darker)}:is(.algolia-search-box>form) button{border-radius:.375rem;margin-right:-.5rem;padding-left:.5rem;padding-right:.5rem}.ais-SearchBox-reset:is(:is(.algolia-search-box>form) button){display:none}@media (min-width:640px){.ais-SearchBox-reset:is(:is(.algolia-search-box>form) button){display:block}}.algolia-hints{flex:1 1 0%;overflow-y:auto;padding-bottom:1rem;padding-top:1rem}:is(.algolia-hints>ol)>li{margin-bottom:.5rem;margin-left:1rem;margin-right:1rem}:is(:is(.algolia-hints>ol)>li):last-child{margin-bottom:0}.algolia-pagination{border-color:var(--foreground-tertiary);border-top-width:1px;padding:.5rem 1.5rem;-webkit-user-select:none;-moz-user-select:none;user-select:none}@media (min-width:640px){.algolia-pagination{padding:.75rem 2rem}}.algolia-pagination>ul{align-items:center;display:flex;gap:.5rem;justify-content:center}.ais-Pagination-item--selected:is(:is(.algolia-pagination>ul)>li)>a{background-color:rgba(82,82,82,.5)!important;transition-duration:.15s;transition-property:color,background-color,border-color,text-decoration-color,fill,stroke;transition-timing-function:cubic-bezier(.4,0,.2,1)}.ais-Pagination-item--disabled:is(:is(.algolia-pagination>ul)>li){color:var(--foreground-secondary)}:is(:is(.algolia-pagination>ul)>li)>a{cursor:pointer;transition-duration:.15s;transition-property:color,background-color,border-color,text-decoration-color,fill,stroke;transition-timing-function:cubic-bezier(.4,0,.2,1)}:is(:is(.algolia-pagination>ul)>li)>a:hover{background-color:rgba(82,82,82,.3)}.item-secondary:is(:is(.algolia-pagination>ul)>li)>a{transition-duration:.15s;transition-property:color,background-color,border-color,text-decoration-color,fill,stroke;transition-timing-function:cubic-bezier(.4,0,.2,1)}.item-secondary:is(:is(.algolia-pagination>ul)>li)>a:hover{background-color:inherit;color:var(--foreground)}.item-converse-color:is(:is(.algolia-pagination>ul)>li)>a{transition-duration:.15s;transition-property:color,background-color,border-color,text-decoration-color,fill,stroke;transition-timing-function:cubic-bezier(.4,0,.2,1)}.item-converse-color:is(:is(.algolia-pagination>ul)>li)>a:hover{background-color:var(--foreground-secondary);color:var(--background-darker)}:is(:is(.algolia-pagination>ul)>li)>a{border-radius:.25rem;font-size:1.125rem;line-height:1.75rem;padding:.25rem .375rem}.pointer-events-none{pointer-events:none}.fixed{position:fixed}.absolute{position:absolute}.relative{position:relative}.sticky{position:sticky}.inset-0{inset:0}.bottom-8{bottom:2rem}.top-0{top:0}.top-\[calc\(var\(--height-header\)\)\]{top:calc(var(--height-header))}.z-20{z-index:20}.z-30{z-index:30}.z-50{z-index:50}.mx-3{margin-left:.75rem;margin-right:.75rem}.mx-5{margin-left:1.25rem;margin-right:1.25rem}.mx-auto{margin-left:auto;margin-right:auto}.my-3{margin-bottom:.75rem;margin-top:.75rem}.-mr-2{margin-right:-.5rem}.mb-1{margin-bottom:.25rem}.mb-12{margin-bottom:3rem}.mb-2{margin-bottom:.5rem}.mb-4{margin-bottom:1rem}.mb-6{margin-bottom:1.5rem}.mb-8{margin-bottom:2rem}.ml-auto{margin-left:auto}.mr-4{margin-right:1rem}.mr-6{margin-right:1.5rem}.mt-12{margin-top:3rem}.mt-16{margin-top:4rem}.mt-2{margin-top:.5rem}.mt-3{margin-top:.75rem}.mt-5{margin-top:1.25rem}.mt-8{margin-top:2rem}.line-clamp-1{-webkit-line-clamp:1}.line-clamp-1,.line-clamp-3{-webkit-box-orient:vertical;display:-webkit-box;overflow:hidden}.line-clamp-3{-webkit-line-clamp:3}.block{display:block}.flex{display:flex}.grid{display:grid}.hidden{display:none}.size-4{height:1rem;width:1rem}.size-5{height:1.25rem;width:1.25rem}.size-8{height:2rem;width:2rem}.size-9{height:2.25rem;width:2.25rem}.h-6{height:1.5rem}.h-\[568px\]{height:568px}.h-\[calc\(100vh-var\(--height-header\)\)\]{height:calc(100vh - var(--height-header))}.h-footer{height:var(--height-footer)}.h-header{height:var(--height-header)}.h-screen{height:100vh}.max-h-\[calc\(100vh-4rem\)\]{max-height:calc(100vh - 4rem)}.min-h-\[calc\(100vh-var\(--height-header\)-var\(--height-footer\)\)\]{min-height:calc(100vh - var(--height-header) - var(--height-footer))}.w-72{width:18rem}.w-8{width:2rem}.w-96{width:24rem}.w-fit{width:-moz-fit-content;width:fit-content}.w-full{width:100%}.max-w-2xl{max-width:42rem}.max-w-xl{max-width:36rem}.flex-1{flex:1 1 0%}.-translate-x-96{--tw-translate-x:-24rem}.-translate-x-96,.translate-x-0{transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skewX(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.translate-x-0{--tw-translate-x:0px}.rotate-45{--tw-rotate:45deg}.rotate-45,.transform{transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skewX(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.cursor-pointer{cursor:pointer}.select-none{-webkit-user-select:none;-moz-user-select:none;user-select:none}.grid-cols-1{grid-template-columns:repeat(1,minmax(0,1fr))}.flex-col{flex-direction:column}.flex-wrap{flex-wrap:wrap}.items-center{align-items:center}.justify-end{justify-content:flex-end}.justify-center{justify-content:center}.justify-between{justify-content:space-between}.gap-1{gap:.25rem}.gap-1\.5{gap:.375rem}.gap-2{gap:.5rem}.gap-3{gap:.75rem}.gap-4{gap:1rem}.gap-y-12{row-gap:3rem}.overflow-auto{overflow:auto}.overflow-hidden{overflow:hidden}.overflow-y-auto{overflow-y:auto}.text-ellipsis{text-overflow:ellipsis}.\!rounded-full{border-radius:9999px!important}.rounded{border-radius:.25rem}.rounded-full{border-radius:9999px}.rounded-lg{border-radius:.5rem}.rounded-md{border-radius:.375rem}.rounded-xl{border-radius:.75rem}.\!border{border-width:1px!important}.border{border-width:1px}.border-2{border-width:2px}.border-l-4{border-left-width:4px}.border-r{border-right-width:1px}.border-t{border-top-width:1px}.border-none{border-style:none}.\!border-primary{border-color:var(--primary)!important}.border-foreground{border-color:var(--foreground)}.border-foreground-tertiary{border-color:var(--foreground-tertiary)}.border-orange-400{--tw-border-opacity:1;border-color:rgb(251 146 60/var(--tw-border-opacity,1))}.\!bg-primary-light{background-color:var(--primary-light)!important}.bg-background{background-color:var(--background)}.bg-background-light{background-color:var(--background-light)}.bg-background-lighter{background-color:var(--background-lighter)}.bg-foreground{background-color:var(--foreground)}.bg-neutral-800{--tw-bg-opacity:1;background-color:rgb(38 38 38/var(--tw-bg-opacity,1))}.bg-neutral-900{--tw-bg-opacity:1;background-color:rgb(23 23 23/var(--tw-bg-opacity,1))}.bg-neutral-900\/0{background-color:hsla(0,0%,9%,0)}.bg-neutral-900\/60{background-color:hsla(0,0%,9%,.6)}.bg-neutral-900\/80{background-color:hsla(0,0%,9%,.8)}.bg-neutral-900\/90{background-color:hsla(0,0%,9%,.9)}.p-0\.5{padding:.125rem}.p-2{padding:.5rem}.p-8{padding:2rem}.\!px-3{padding-left:.75rem!important;padding-right:.75rem!important}.\!py-1\.5{padding-bottom:.375rem!important;padding-top:.375rem!important}.px-16{padding-left:4rem;padding-right:4rem}.px-3{padding-left:.75rem;padding-right:.75rem}.px-4{padding-left:1rem;padding-right:1rem}.px-5{padding-left:1.25rem;padding-right:1.25rem}.px-6{padding-left:1.5rem;padding-right:1.5rem}.px-8{padding-left:2rem;padding-right:2rem}.py-0\.5{padding-bottom:.125rem;padding-top:.125rem}.py-2{padding-bottom:.5rem;padding-top:.5rem}.py-3{padding-bottom:.75rem;padding-top:.75rem}.py-4{padding-bottom:1rem;padding-top:1rem}.pl-16{padding-left:4rem}.text-center{text-align:center}.\!text-sm{font-size:.875rem!important;line-height:1.25rem!important}.text-3xl{font-size:1.875rem;line-height:2.25rem}.text-base{font-size:1rem;line-height:1.5rem}.text-lg{font-size:1.125rem;line-height:1.75rem}.text-sm{font-size:.875rem;line-height:1.25rem}.text-xl{font-size:1.25rem;line-height:1.75rem}.font-bold{font-weight:700}.font-medium{font-weight:500}.leading-none{line-height:1}.\!text-background{color:var(--background)!important}.\!text-primary{color:var(--primary)!important}.text-background{color:var(--background)}.text-foreground{color:var(--foreground)}.text-foreground-secondary{color:var(--foreground-secondary)}.text-neutral-300{--tw-text-opacity:1;color:rgb(212 212 212/var(--tw-text-opacity,1))}.text-primary-light{color:var(--primary-light)}.opacity-0{opacity:0}.opacity-100{opacity:1}.opacity-80{opacity:.8}.shadow-sm{--tw-shadow:0 1px 2px 0 rgba(0,0,0,.05);--tw-shadow-colored:0 1px 2px 0 var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow,0 0 #0000),var(--tw-ring-shadow,0 0 #0000),var(--tw-shadow)}.shadow-primary-dark{--tw-shadow-color:var(--primary-dark);--tw-shadow:var(--tw-shadow-colored)}.filter{filter:var(--tw-blur) var(--tw-brightness) var(--tw-contrast) var(--tw-grayscale) var(--tw-hue-rotate) var(--tw-invert) var(--tw-saturate) var(--tw-sepia) var(--tw-drop-shadow)}.backdrop-blur-sm{--tw-backdrop-blur:blur(4px);-webkit-backdrop-filter:var(--tw-backdrop-blur) var(--tw-backdrop-brightness) var(--tw-backdrop-contrast) var(--tw-backdrop-grayscale) var(--tw-backdrop-hue-rotate) var(--tw-backdrop-invert) var(--tw-backdrop-opacity) var(--tw-backdrop-saturate) var(--tw-backdrop-sepia);backdrop-filter:var(--tw-backdrop-blur) var(--tw-backdrop-brightness) var(--tw-backdrop-contrast) var(--tw-backdrop-grayscale) var(--tw-backdrop-hue-rotate) var(--tw-backdrop-invert) var(--tw-backdrop-opacity) var(--tw-backdrop-saturate) var(--tw-backdrop-sepia)}.\!transition{transition-duration:.15s!important;transition-property:color,background-color,border-color,text-decoration-color,fill,stroke,opacity,box-shadow,transform,filter,-webkit-backdrop-filter!important;transition-property:color,background-color,border-color,text-decoration-color,fill,stroke,opacity,box-shadow,transform,filter,backdrop-filter!important;transition-property:color,background-color,border-color,text-decoration-color,fill,stroke,opacity,box-shadow,transform,filter,backdrop-filter,-webkit-backdrop-filter!important;transition-timing-function:cubic-bezier(.4,0,.2,1)!important}.transition{transition-duration:.15s;transition-property:color,background-color,border-color,text-decoration-color,fill,stroke,opacity,box-shadow,transform,filter,-webkit-backdrop-filter;transition-property:color,background-color,border-color,text-decoration-color,fill,stroke,opacity,box-shadow,transform,filter,backdrop-filter;transition-property:color,background-color,border-color,text-decoration-color,fill,stroke,opacity,box-shadow,transform,filter,backdrop-filter,-webkit-backdrop-filter;transition-timing-function:cubic-bezier(.4,0,.2,1)}.duration-500{transition-duration:.5s}.before\:mx-1:before{content:var(--tw-content);margin-left:.25rem;margin-right:.25rem}.before\:mx-1\.5:before{content:var(--tw-content);margin-left:.375rem;margin-right:.375rem}.before\:mx-2:before{content:var(--tw-content);margin-left:.5rem;margin-right:.5rem}.before\:mr-0\.5:before{content:var(--tw-content);margin-right:.125rem}.before\:text-sm:before{content:var(--tw-content);font-size:.875rem;line-height:1.25rem}.before\:content-\[\'\#\'\]:before{--tw-content:"#";content:var(--tw-content)}.before\:content-\[\'\/\'\]:before{--tw-content:"/";content:var(--tw-content)}.before\:content-\[\'\2022\'\]:before{--tw-content:"•";content:var(--tw-content)}.hover\:\!border-solid:hover{border-style:solid!important}.hover\:\!border-primary:hover{border-color:var(--primary)!important}.hover\:\!border-primary-light:hover{border-color:var(--primary-light)!important}.hover\:border-foreground-secondary:hover{border-color:var(--foreground-secondary)}.hover\:border-primary-dark:hover{border-color:var(--primary-dark)}.hover\:\!bg-primary:hover{background-color:var(--primary)!important}.hover\:bg-foreground:hover{background-color:var(--foreground)}.hover\:bg-foreground-secondary:hover{background-color:var(--foreground-secondary)}.hover\:\!text-primary-light:hover{color:var(--primary-light)!important}.hover\:text-background:hover{color:var(--background)}.hover\:text-background-darker:hover{color:var(--background-darker)}.hover\:\!no-underline:hover{text-decoration-line:none!important}.hover\:shadow:hover{--tw-shadow:0 1px 3px 0 rgba(0,0,0,.1),0 1px 2px -1px rgba(0,0,0,.1);--tw-shadow-colored:0 1px 3px 0 var(--tw-shadow-color),0 1px 2px -1px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow,0 0 #0000),var(--tw-ring-shadow,0 0 #0000),var(--tw-shadow)}.hover\:shadow-primary:hover{--tw-shadow-color:var(--primary);--tw-shadow:var(--tw-shadow-colored)}@media (min-width:640px){.sm\:w-96{width:24rem}}@media (min-width:768px){.md\:line-clamp-4{-webkit-box-orient:vertical;-webkit-line-clamp:4;display:-webkit-box;overflow:hidden}.md\:block{display:block}.md\:grid-cols-2{grid-template-columns:repeat(2,minmax(0,1fr))}.md\:flex-row{flex-direction:row}.md\:items-center{align-items:center}}@media (min-width:1024px){.lg\:hidden{display:none}.lg\:grid-cols-1{grid-template-columns:repeat(1,minmax(0,1fr))}.lg\:flex-row{flex-direction:row}.lg\:bg-neutral-900\/80{background-color:hsla(0,0%,9%,.8)}.lg\:px-16{padding-left:4rem;padding-right:4rem}.lg\:py-12{padding-bottom:3rem;padding-top:3rem}.lg\:before\:content-\[\'\2022\'\]:before{--tw-content:"•";content:var(--tw-content)}}@media (min-width:1280px){.xl\:grid-cols-2{grid-template-columns:repeat(2,minmax(0,1fr))}}@media (min-width:1536px){.\32xl\:block{display:block}.\32xl\:w-88{width:22rem}.\32xl\:px-24{padding-left:6rem;padding-right:6rem}}@media print{.print\:block{display:block}.print\:hidden{display:none}.print\:h-auto{height:auto}}</style><link rel="sitemap" type="application/xml" href="/sitemap-index.xml"/><style>.gatsby-image-wrapper{position:relative;overflow:hidden}.gatsby-image-wrapper picture.object-fit-polyfill{position:static!important}.gatsby-image-wrapper img{bottom:0;height:100%;left:0;margin:0;max-width:none;padding:0;position:absolute;right:0;top:0;width:100%;object-fit:cover}.gatsby-image-wrapper [data-main-image]{opacity:0;transform:translateZ(0);transition:opacity .25s linear;will-change:opacity}.gatsby-image-wrapper-constrained{display:inline-block;vertical-align:top}</style><noscript><style>.gatsby-image-wrapper noscript [data-main-image]{opacity:1!important}.gatsby-image-wrapper [data-placeholder-image]{opacity:0!important}</style></noscript><script type="module">const e="undefined"!=typeof HTMLImageElement&&"loading"in HTMLImageElement.prototype;e&&document.body.addEventListener("load",(function(e){const t=e.target;if(void 0===t.dataset.mainImage)return;if(void 0===t.dataset.gatsbyImageSsr)return;let a=null,n=t;for(;null===a&&n;)void 0!==n.parentNode.dataset.gatsbyImageWrapper&&(a=n.parentNode),n=n.parentNode;const o=a.querySelector("[data-placeholder-image]"),r=new Image;r.src=t.currentSrc,r.decode().catch((()=>{})).then((()=>{t.style.opacity=1,o&&(o.style.opacity=0,o.style.transition="opacity 500ms linear")}))}),!0);</script><link rel="icon" href="/favicon-32x32.png?v=1fec866ca6596b60d4f4210b380a1221" type="image/png"/><link rel="manifest" href="/manifest.webmanifest" crossorigin="anonymous"/><link rel="apple-touch-icon" sizes="48x48" href="/icons/icon-48x48.png?v=1fec866ca6596b60d4f4210b380a1221"/><link rel="apple-touch-icon" sizes="72x72" href="/icons/icon-72x72.png?v=1fec866ca6596b60d4f4210b380a1221"/><link rel="apple-touch-icon" sizes="96x96" href="/icons/icon-96x96.png?v=1fec866ca6596b60d4f4210b380a1221"/><link rel="apple-touch-icon" sizes="144x144" href="/icons/icon-144x144.png?v=1fec866ca6596b60d4f4210b380a1221"/><link rel="apple-touch-icon" sizes="192x192" href="/icons/icon-192x192.png?v=1fec866ca6596b60d4f4210b380a1221"/><link rel="apple-touch-icon" sizes="256x256" href="/icons/icon-256x256.png?v=1fec866ca6596b60d4f4210b380a1221"/><link rel="apple-touch-icon" sizes="384x384" href="/icons/icon-384x384.png?v=1fec866ca6596b60d4f4210b380a1221"/><link rel="apple-touch-icon" sizes="512x512" href="/icons/icon-512x512.png?v=1fec866ca6596b60d4f4210b380a1221"/><link rel="alternate" type="application/rss+xml" title="Lolipop&#x27;s Studio | RSS Feed" href="/rss.xml"/><title data-gatsby-head="true">基于 Gatsby 打造我的个人博客系统 • Lolipop&#x27;s Studio</title></head><body><div id="___gatsby"><div style="outline:none" tabindex="-1" id="gatsby-focus-wrapper"><div class="flex h-screen print:h-auto"><div class="absolute inset-0 z-50 bg-neutral-900 transition duration-500 "></div><aside class="border-r border-foreground-tertiary bg-background-light hidden w-72 2xl:block print:hidden"><div class="flex h-header items-center "><div class="mx-5 flex h-header items-center px-4"><div class="text-lg font-bold">Lolipop&#x27;s Studio</div></div></div><div class="h-[calc(100vh-var(--height-header))] overflow-y-auto px-4"><div><nav class="mb-6"><ul><a class="item-selectable flex items-center rounded-lg px-3 py-2 mb-1 text-base " href="/"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="house" class="svg-inline--fa fa-house w-8" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512"><path fill="currentColor" d="M575.8 255.5c0 18-15 32.1-32 32.1l-32 0 .7 160.2c0 2.7-.2 5.4-.5 8.1l0 16.2c0 22.1-17.9 40-40 40l-16 0c-1.1 0-2.2 0-3.3-.1c-1.4 .1-2.8 .1-4.2 .1L416 512l-24 0c-22.1 0-40-17.9-40-40l0-24 0-64c0-17.7-14.3-32-32-32l-64 0c-17.7 0-32 14.3-32 32l0 64 0 24c0 22.1-17.9 40-40 40l-24 0-31.9 0c-1.5 0-3-.1-4.5-.2c-1.2 .1-2.4 .2-3.6 .2l-16 0c-22.1 0-40-17.9-40-40l0-112c0-.9 0-1.9 .1-2.8l0-69.7-32 0c-18 0-32-14-32-32.1c0-9 3-17 10-24L266.4 8c7-7 15-8 22-8s15 2 21 7L564.8 231.5c8 7 12 15 11 24z"></path></svg><span class="mr-6 flex-1 overflow-hidden text-ellipsis">主页</span></a><a class="item-selectable flex items-center rounded-lg px-3 py-2 mb-1 text-base " href="/about-me/"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="id-card" class="svg-inline--fa fa-id-card w-8" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512"><path fill="currentColor" d="M0 96l576 0c0-35.3-28.7-64-64-64L64 32C28.7 32 0 60.7 0 96zm0 32L0 416c0 35.3 28.7 64 64 64l448 0c35.3 0 64-28.7 64-64l0-288L0 128zM64 405.3c0-29.5 23.9-53.3 53.3-53.3l117.3 0c29.5 0 53.3 23.9 53.3 53.3c0 5.9-4.8 10.7-10.7 10.7L74.7 416c-5.9 0-10.7-4.8-10.7-10.7zM176 192a64 64 0 1 1 0 128 64 64 0 1 1 0-128zm176 16c0-8.8 7.2-16 16-16l128 0c8.8 0 16 7.2 16 16s-7.2 16-16 16l-128 0c-8.8 0-16-7.2-16-16zm0 64c0-8.8 7.2-16 16-16l128 0c8.8 0 16 7.2 16 16s-7.2 16-16 16l-128 0c-8.8 0-16-7.2-16-16zm0 64c0-8.8 7.2-16 16-16l128 0c8.8 0 16 7.2 16 16s-7.2 16-16 16l-128 0c-8.8 0-16-7.2-16-16z"></path></svg><span class="mr-6 flex-1 overflow-hidden text-ellipsis">关于我</span></a></ul></nav><nav class="mb-6"><div class="mb-2 px-5 text-sm font-bold text-foreground-secondary">发现博客</div><ul><a class="item-selectable flex items-center rounded-lg px-3 py-2 mb-1 text-base " href="/categories/"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="folder" class="svg-inline--fa fa-folder w-8" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M64 480H448c35.3 0 64-28.7 64-64V160c0-35.3-28.7-64-64-64H288c-10.1 0-19.6-4.7-25.6-12.8L243.2 57.6C231.1 41.5 212.1 32 192 32H64C28.7 32 0 60.7 0 96V416c0 35.3 28.7 64 64 64z"></path></svg><span class="mr-6 flex-1 overflow-hidden text-ellipsis">分类</span></a><a class="item-selectable flex items-center rounded-lg px-3 py-2 mb-1 text-base " href="/tags/"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="tags" class="svg-inline--fa fa-tags w-8" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M345 39.1L472.8 168.4c52.4 53 52.4 138.2 0 191.2L360.8 472.9c-9.3 9.4-24.5 9.5-33.9 .2s-9.5-24.5-.2-33.9L438.6 325.9c33.9-34.3 33.9-89.4 0-123.7L310.9 72.9c-9.3-9.4-9.2-24.6 .2-33.9s24.6-9.2 33.9 .2zM0 229.5L0 80C0 53.5 21.5 32 48 32l149.5 0c17 0 33.3 6.7 45.3 18.7l168 168c25 25 25 65.5 0 90.5L277.3 442.7c-25 25-65.5 25-90.5 0l-168-168C6.7 262.7 0 246.5 0 229.5zM144 144a32 32 0 1 0 -64 0 32 32 0 1 0 64 0z"></path></svg><span class="mr-6 flex-1 overflow-hidden text-ellipsis">标签</span></a></ul></nav><nav class="mb-6"><div class="mb-2 px-5 text-sm font-bold text-foreground-secondary">找到博主</div><ul><a href="https://timeline.towind.fun" target="_blank" rel="noreferrer" class="item-selectable flex items-center rounded-lg px-3 py-2 mb-1 text-base "><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="comment-dots" class="svg-inline--fa fa-comment-dots w-8" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M256 448c141.4 0 256-93.1 256-208S397.4 32 256 32S0 125.1 0 240c0 45.1 17.7 86.8 47.7 120.9c-1.9 24.5-11.4 46.3-21.4 62.9c-5.5 9.2-11.1 16.6-15.2 21.6c-2.1 2.5-3.7 4.4-4.9 5.7c-.6 .6-1 1.1-1.3 1.4l-.3 .3c0 0 0 0 0 0c0 0 0 0 0 0s0 0 0 0s0 0 0 0c-4.6 4.6-5.9 11.4-3.4 17.4c2.5 6 8.3 9.9 14.8 9.9c28.7 0 57.6-8.9 81.6-19.3c22.9-10 42.4-21.9 54.3-30.6c31.8 11.5 67 17.9 104.1 17.9zM128 208a32 32 0 1 1 0 64 32 32 0 1 1 0-64zm128 0a32 32 0 1 1 0 64 32 32 0 1 1 0-64zm96 32a32 32 0 1 1 64 0 32 32 0 1 1 -64 0z"></path></svg><span class="mr-6 flex-1 overflow-hidden text-ellipsis">时间线</span><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="arrow-up" class="svg-inline--fa fa-arrow-up ml-auto w-8 rotate-45" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 384 512"><path fill="currentColor" d="M214.6 41.4c-12.5-12.5-32.8-12.5-45.3 0l-160 160c-12.5 12.5-12.5 32.8 0 45.3s32.8 12.5 45.3 0L160 141.2 160 448c0 17.7 14.3 32 32 32s32-14.3 32-32l0-306.7L329.4 246.6c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3l-160-160z"></path></svg></a><a href="mailto:mail@towind.fun" target="_blank" rel="noreferrer" class="item-selectable flex items-center rounded-lg px-3 py-2 mb-1 text-base "><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="envelope" class="svg-inline--fa fa-envelope w-8" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M48 64C21.5 64 0 85.5 0 112c0 15.1 7.1 29.3 19.2 38.4L236.8 313.6c11.4 8.5 27 8.5 38.4 0L492.8 150.4c12.1-9.1 19.2-23.3 19.2-38.4c0-26.5-21.5-48-48-48L48 64zM0 176L0 384c0 35.3 28.7 64 64 64l384 0c35.3 0 64-28.7 64-64l0-208L294.4 339.2c-22.8 17.1-54 17.1-76.8 0L0 176z"></path></svg><span class="mr-6 flex-1 overflow-hidden text-ellipsis">mail@towind.fun</span><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="arrow-up" class="svg-inline--fa fa-arrow-up ml-auto w-8 rotate-45" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 384 512"><path fill="currentColor" d="M214.6 41.4c-12.5-12.5-32.8-12.5-45.3 0l-160 160c-12.5 12.5-12.5 32.8 0 45.3s32.8 12.5 45.3 0L160 141.2 160 448c0 17.7 14.3 32 32 32s32-14.3 32-32l0-306.7L329.4 246.6c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3l-160-160z"></path></svg></a><a href="https://github.com/LolipopJ" target="_blank" rel="noreferrer" class="item-selectable flex items-center rounded-lg px-3 py-2 mb-1 text-base "><svg aria-hidden="true" focusable="false" data-prefix="fab" data-icon="github" class="svg-inline--fa fa-github w-8" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><path fill="currentColor" d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"></path></svg><span class="mr-6 flex-1 overflow-hidden text-ellipsis">@LolipopJ</span><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="arrow-up" class="svg-inline--fa fa-arrow-up ml-auto w-8 rotate-45" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 384 512"><path fill="currentColor" d="M214.6 41.4c-12.5-12.5-32.8-12.5-45.3 0l-160 160c-12.5 12.5-12.5 32.8 0 45.3s32.8 12.5 45.3 0L160 141.2 160 448c0 17.7 14.3 32 32 32s32-14.3 32-32l0-306.7L329.4 246.6c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3l-160-160z"></path></svg></a><a href="https://steamcommunity.com/id/lolipopj_703" target="_blank" rel="noreferrer" class="item-selectable flex items-center rounded-lg px-3 py-2 mb-1 text-base "><svg aria-hidden="true" focusable="false" data-prefix="fab" data-icon="steam" class="svg-inline--fa fa-steam w-8" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><path fill="currentColor" d="M496 256c0 137-111.2 248-248.4 248-113.8 0-209.6-76.3-239-180.4l95.2 39.3c6.4 32.1 34.9 56.4 68.9 56.4 39.2 0 71.9-32.4 70.2-73.5l84.5-60.2c52.1 1.3 95.8-40.9 95.8-93.5 0-51.6-42-93.5-93.7-93.5s-93.7 42-93.7 93.5v1.2L176.6 279c-15.5-.9-30.7 3.4-43.5 12.1L0 236.1C10.2 108.4 117.1 8 247.6 8 384.8 8 496 119 496 256zM155.7 384.3l-30.5-12.6a52.79 52.79 0 0 0 27.2 25.8c26.9 11.2 57.8-1.6 69-28.4 5.4-13 5.5-27.3.1-40.3-5.4-13-15.5-23.2-28.5-28.6-12.9-5.4-26.7-5.2-38.9-.6l31.5 13c19.8 8.2 29.2 30.9 20.9 50.7-8.3 19.9-31 29.2-50.8 21zm173.8-129.9c-34.4 0-62.4-28-62.4-62.3s28-62.3 62.4-62.3 62.4 28 62.4 62.3-27.9 62.3-62.4 62.3zm.1-15.6c25.9 0 46.9-21 46.9-46.8 0-25.9-21-46.8-46.9-46.8s-46.9 21-46.9 46.8c.1 25.8 21.1 46.8 46.9 46.8z"></path></svg><span class="mr-6 flex-1 overflow-hidden text-ellipsis">@lolipopj_703</span><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="arrow-up" class="svg-inline--fa fa-arrow-up ml-auto w-8 rotate-45" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 384 512"><path fill="currentColor" d="M214.6 41.4c-12.5-12.5-32.8-12.5-45.3 0l-160 160c-12.5 12.5-12.5 32.8 0 45.3s32.8 12.5 45.3 0L160 141.2 160 448c0 17.7 14.3 32 32 32s32-14.3 32-32l0-306.7L329.4 246.6c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3l-160-160z"></path></svg></a></ul></nav></div></div></aside><aside class="border-r border-foreground-tertiary bg-background-light print:hidden fixed top-[calc(var(--height-header))] z-20 h-[calc(100vh-var(--height-header))] w-full border-none transition sm:w-96 pointer-events-none -translate-x-96 opacity-0"><div class="flex h-header items-center px-4 mx-3"><ul class="flex select-none gap-1 rounded-full border border-foreground-tertiary bg-neutral-800 p-0.5"><li class="cursor-pointer rounded-full px-3 py-0.5 font-medium transition ">导航</li><li class="cursor-pointer rounded-full px-3 py-0.5 font-medium transition ">博客列表</li></ul></div><div class="h-[calc(100vh-var(--height-header))] overflow-y-auto px-4"></div></aside><main class="flex-1 overflow-auto"><header class="sticky top-0 z-20 flex h-header items-center bg-background-light px-8 backdrop-blur-sm lg:bg-neutral-900/80 print:hidden"><div class="item-selectable mr-4 flex size-8 items-center justify-center rounded-md border-2 border-foreground lg:hidden "><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="bars" class="svg-inline--fa fa-bars size-4" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path fill="currentColor" d="M0 96C0 78.3 14.3 64 32 64l384 0c17.7 0 32 14.3 32 32s-14.3 32-32 32L32 128C14.3 128 0 113.7 0 96zM0 256c0-17.7 14.3-32 32-32l384 0c17.7 0 32 14.3 32 32s-14.3 32-32 32L32 288c-17.7 0-32-14.3-32-32zM448 416c0 17.7-14.3 32-32 32L32 448c-17.7 0-32-14.3-32-32s14.3-32 32-32l384 0c17.7 0 32 14.3 32 32z"></path></svg></div><div class="line-clamp-1 flex flex-1 items-center text-lg font-bold"></div><div class="ml-auto justify-end pl-16"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="magnifying-glass" class="svg-inline--fa fa-magnifying-glass item-selectable rounded-md p-2" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M416 208c0 45.9-14.9 88.3-40 122.7L502.6 457.4c12.5 12.5 12.5 32.8 0 45.3s-32.8 12.5-45.3 0L330.7 376c-34.4 25.2-76.8 40-122.7 40C93.1 416 0 322.9 0 208S93.1 0 208 0S416 93.1 416 208zM208 352a144 144 0 1 0 0-288 144 144 0 1 0 0 288z"></path></svg></div></header><div class="relative min-h-[calc(100vh-var(--height-header)-var(--height-footer))] p-8 lg:px-16 lg:py-12 2xl:px-24"><div class="mb-12 hidden print:block"><div>Site: <!-- -->Lolipop&#x27;s Studio</div><div>Date: <!-- -->2025-03-17T08:06:14.449Z</div><div>Source:<!-- --> <a target="_blank" rel="noreferrer" class="item-link"></a></div></div><div class="mx-auto flex max-w-xl flex-col gap-y-12"><div class="flex flex-col gap-4"><a class="item-converse-color w-fit rounded px-3 py-2 text-sm leading-none hover:border-primary-dark item-selectable" href="/categories/%E5%89%8D%E7%AB%AF%E5%BC%80%E5%8F%91/">前端开发</a><h1 class="text-3xl font-bold">基于 Gatsby 打造我的个人博客系统</h1><div class="item-secondary flex flex-col gap-2 lg:flex-row"><span title="首次发布于：Wed, 12 Mar 2025 00:00:00 GMT
最后更新于：Fri, 14 Mar 2025 00:00:00 GMT">03 月 12 日 2025 年</span><div class="flex flex-1 flex-wrap gap-2 lg:before:content-[&#x27;•&#x27;]"><a class="before:mr-0.5 before:text-sm before:content-[&#x27;#&#x27;] item-secondary item-selectable" href="/tags/React/">React</a><a class="before:mr-0.5 before:text-sm before:content-[&#x27;#&#x27;] item-secondary item-selectable" href="/tags/TypeScript/">TypeScript</a><a class="before:mr-0.5 before:text-sm before:content-[&#x27;#&#x27;] item-secondary item-selectable" href="/tags/Gatsby/">Gatsby</a></div></div></div><article class="heti post-entry"><h2>碎碎念</h2>
<p>搭建一个自己的博客是无数跻身于 IT 行业开发者的心中最质朴的愿望！</p>
<p>回想笔者的历程，刚上大学的时候就摩拳擦掌想要实现一个博客系统，但在 Github 上创建了仓库以后就开始了无限期的拖延：自己没有任何的开发经验，不知道框架也不知道 UI 组件库，只知道要写 HTML + CSS + JavaScript 代码，面对眼前想要实现的完整系统不知该如何下手。</p>
<p>从零开始实现博客系统的计划虽然搁浅，但是拥有一个自己的博客的愿望没有改变。如果自己还没有能力去开发，那末至少基于现有的博客平台去搭建一个博客吧，毕竟对于博客来说，最重要的还是内容本身。终于在大二上学期的时候收集资料，横向对比，考量不同博客平台的优势与短板，最终选择了基于 Hexo 搭建自己的静态博客系统，能够部署在 Github Pages 上而不需要自己去维护服务器。还根据自己搭建的经验，模仿别人写了一篇搭建 Hexo 博客的<a href="/posts/hello-hexo-world/">简易教程</a>，这篇教程也顺理成章成为了自己的第一篇技术博客。</p>
<p>Hexo 由目录结构驱动，简单好用，作为博主可以全身心投入到博客的撰写中去。Hexo 的生态里已经有着非常多的惹眼且实用的博客主题，下载到到对应目录下再修改全局配置项即可一键启用。笔者在大学生涯相当慢热，直到认为自己应该开始做某件事情时，才不留余力地去 push 自己，可谓是充分享受了青春。因此在拥有了博客系统之后，反而失去了很多原初的动力，又因为自己并没有沉浸于对技术的学习中去，也就没有什么好写下来记成博客的。</p>
<p>直到大三下学期，笔者选定了成为前端开发工程师的道路，在众多面经中看到了博客的重要性，于是开始慢慢写起来。将实习 遇到的困难，竞赛项目里的开发经验，以及自学过程中的收获整理为一篇篇博客，上传到自己的仓库里。望着终于能翻页的个人博客，一种纯粹的满足感油然而生。</p>
<p>后来又觉得自己的大学生涯有些太平淡了，于是便挑战向 Github 别人的项目提交 PR，其中提的最多的 PR 是给自己在用的博客主题 —— <a href="https://github.com/fi3ework/hexo-theme-archer" target="_blank" rel="noreferrer">hexo-theme-archer</a> 的，另外还成功申请成为了它的维护者，自发地帮忙去解决堆积的 Issues。现在想来那时候的自己还非常的稚嫩，Issues 里提什么就做什么，没有认真分析过它是否真的是一个问题。例如有个 Issue 提到希望提供图片左右浮动的功能，自己就写了两个样式类塞到主题里并贴上如何使用，但实际上这样的功能只需要博主在撰写博客的时候使用 <span><code class="language-text">&lt;img></code></span> 标签的形式再添加行内样式就可以了。不过当然也有自认为做得不错的工作，例如看到有人提了一个 PR 为主题添加了暗色模式支持，一下子激发起了我的兴趣，于是在这个 PR 的基础上花了几天的功夫实现了完全的暗色模式适配，想必为大家的眼睛起到了一些保护的作用。</p>
<p>时间流转，随着前端开发成为了自己的工作，站点开发已然成为烹小鲜般的事情，不再神秘。某天笔者偶然看到了 <a href="https://thesis.priority.vision/" target="_blank" rel="noreferrer">Thesis Theme Vision</a>，很有笔记软件的感觉，十分符合自己对博客系统的审美喜好，终于耐不住想要去复刻实现的愿望，于是又创建了一个 Github 仓库。这一次，确实从零开始了自己的博客系统搭建工程。</p>
<h2>技术选型</h2>
<p>笔者最初考虑的是为 Hexo 开发一个主题，但是我实在很难投入到学习其支持的 EJS 或 Pug 这些模板语言中去，思  来想去还是继续投资到我擅长的且更有未来的 React 中去吧，遂决定另起炉灶。</p>
<p>接下来无论是选择 Next.js 或 Umi 作为开发框架都没有问题，甚至直接基于 React 手搓也没有问题，但笔者还是对 Gatsby 和 Docusaurus 这类所谓的“静态站点生成器”非常感兴趣。考虑到笔者自身对博客系统高可自定义性的需要，最终选择了 Gatsby 作为框架。核心使用到的库版本如下：</p>
<ul>
<li><span><code class="language-text">gatsby@^5.0.0</code></span></li>
<li><span><code class="language-text">react@^18.0.0</code></span></li>
</ul>
<h2>解析并渲染博客</h2>
<h3>解析 <span><code class="language-text">.mdx</code></span> 文件为博客</h3>
<p>不同于 Hexo 的将文件塞到 <span><code class="language-text">source/_posts/</code></span> 目录下即识别为一篇博客，Gatsby 要求开发者实现“解析数据源到数据层”和“组件从数据层查询”两个阶段的工作。援引官方文档的数据层介绍图片如下：</p>
<span><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 624px; "
    >
      <a
    class="gatsby-resp-image-link"
    href="/static/b39469a6cc4b6e74a3741eeb1c86e81e/5df5d/data-layer.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
    <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 64.1025641025641%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAIAAAAmMtkJAAAACXBIWXMAABYlAAAWJQFJUiTwAAABwUlEQVR42k1Sa2/bMAz0//9fQ/e1QItiQbM265wYsWPrSVIvuyc57UYYNk0ej+JRnaQyu+AkjTbgoZjxLD4iEnNRFBG8uaApprL6kKb2SyEj2xlOx6v/M9PLWf8aLHIoOwy2IdJp8ggeBgPHhzy58PxXAQlS/HZlXYnIWBtjiDGWgsAWQmCWtRl8JNZtS7lIiEEEmFRKLqWD158vx7f3GFPOCUQAb9tmjE0poVgpDUJhISYAtmqVtOzFMBQaqgdeHJ9HZSguxivHCE7a4d2Py+LFSkQK46yl1neNaYMYUK5ytl/4r1f/MdNZca/konj7spRXqLUju32wXFawekmGK7eVdNU0WVmcTJZnH2ucK8BJXUQ7eOvsiTEhZsZsUKVKyEzEiDAz5HLe5zocekCn+8B1ZhT3l+H55WCd26UIzeDnnHcHyoEFqe/D3wXDBxsCDppJzLdFGV9xUMERa21jbgtLSRnH2FVrfe+8e3jj9oxWTqPB8CFlSHrVfFkIEwKALPx+9hi7lv+vNgwiPfXmx+utXxj0UPU00eOHxhVEFhf24Tj//D0PWr5L/hW3gnqG1gnK1ZOjCZjahgoA+Wuje/EnVZXyme63+XEAAAAASUVORK5CYII='); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="data layer"
        title=""
        src="/static/b39469a6cc4b6e74a3741eeb1c86e81e/39c09/data-layer.png"
        srcset="/static/b39469a6cc4b6e74a3741eeb1c86e81e/680fe/data-layer.png 156w,
/static/b39469a6cc4b6e74a3741eeb1c86e81e/17474/data-layer.png 312w,
/static/b39469a6cc4b6e74a3741eeb1c86e81e/39c09/data-layer.png 624w,
/static/b39469a6cc4b6e74a3741eeb1c86e81e/6d2da/data-layer.png 936w,
/static/b39469a6cc4b6e74a3741eeb1c86e81e/5a791/data-layer.png 1248w,
/static/b39469a6cc4b6e74a3741eeb1c86e81e/5df5d/data-layer.png 1572w"
        sizes="(max-width: 624px) 100vw, 624px"
        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
        loading="lazy"
        decoding="async"
      />
  </a>
    </span></span>
<p>解析数据源到数据层可以通过<strong>源插件</strong>实现，官方约定源插件以 <span><code class="language-text">gatsby-source-</code></span> 开头。笔者现在想要将本地的 <span><code class="language-text">.mdx</code></span> 文件解析到数据层，可以通过插件 <a href="https://www.gatsbyjs.com/plugins/gatsby-source-filesystem/" target="_blank" rel="noreferrer"><span><code class="language-text">gatsby-source-filesystem</code></span></a> 实现。编辑 <span><code class="language-text">gatsby-config.ts</code></span>，添加此插件并配置欲解析的本地目录：</p>
<span><div class="gatsby-highlight" data-language="ts"><pre class="language-ts"><code class="language-ts"><span class="token keyword">import</span> <span class="token keyword">type</span> <span class="token punctuation">{</span> GatsbyConfig <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">"gatsby"</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> config<span class="token operator">:</span> GatsbyConfig <span class="token operator">=</span> <span class="token punctuation">{</span>
  plugins<span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token punctuation">{</span>
      resolve<span class="token operator">:</span> <span class="token string">"gatsby-source-filesystem"</span><span class="token punctuation">,</span> <span class="token comment">// 尽管官方文档在使用字符串时都使用的是反引号 `，但笔者更习惯使用单双引号</span>
      options<span class="token operator">:</span> <span class="token punctuation">{</span>
        name<span class="token operator">:</span> <span class="token string">"posts"</span><span class="token punctuation">,</span>
        path<span class="token operator">:</span> <span class="token string">"path/to/posts/"</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      __key<span class="token operator">:</span> <span class="token string">"posts"</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> config<span class="token punctuation">;</span></code></pre></div></span>
<p>上面的配置项表示插件将自动读取 <span><code class="language-text">path/to/posts/</code></span> 目录下的文件信息。</p>
<p>但这还不够，源插件 <span><code class="language-text">gatsby-source-filesystem</code></span> 仅允许查询与文件相关的元数据，但是却无法读取文件包含的具体内容。为了读取到文件内容，就要用到<strong>转换器插件</strong>。对于 <span><code class="language-text">.mdx</code></span> 格式的 File 节点，可以通过插件 <a href="https://www.gatsbyjs.com/plugins/gatsby-plugin-mdx/" target="_blank" rel="noreferrer"><span><code class="language-text">gatsby-plugin-mdx</code></span></a> 转换为 MDX 节点。官方文档里的这张图能直观描述这个过程：</p>
<span><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 624px; "
    >
      <a
    class="gatsby-resp-image-link"
    href="/static/577b8e2bf994db9c7f6b2370764ce93d/5df5d/data-layer-with-nodes.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
    <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 80.76923076923077%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAQCAIAAACZeshMAAAACXBIWXMAABYlAAAWJQFJUiTwAAAB+0lEQVR42m1Ti44aMQzk//+rUn/gWlV3pdwBC8u+87TjPDpL4KDqRSZyTGZtjyebUkrOOaYsMdcFP113WM4l3cKlxnMpdcfa4Dca3l4M7OWw7HpnOe5Hd5yc9rLr7K+Tem11p0m58Naan40aNFFIN3BMaTF+NUvTosd5cSzGB8QpROXYkEhMyKxwwXjPEX/dwTG97/fH5iQiH/vD9s+OiLz3tSPrXC0TQSaqwfQJRg8wJDEUJmVdiLOl2XgckVY5siQwZb0PAgOyfm5T7sujslKcXxec98EdZjorbia/uHBNuOYkSTe6nsFISBz6cWzbi9JaG7t20l44yDwvl64fpxklgoovwJaiZRrcPHk1+AUdns9t1w8iIdkhmjHZMQv78Dmp58y8gkdaTqafSAF8ODYApxiLn4o+F90mIZL8BRj1WA6Og/IeOwUZF6UtwpEDM1IyhZWwdK/6znYVFsbrSGhtPoJbOI6CJeAiOmVJDGcd/xPb8JrTebt7Bx/1iDHHuCqBGTzjSHWwdf0755RA7zQvq6RFnHOCPkuBZqpUkAlB5odCHuB8X+DsOOgOY40JGuyUP03GXbU5O/7oFu3Xqm8P5ZkwHHvN37fTy1GhWzyy3xfzo9F4J7i+7e23txHKQbyU/+aMGK7hw9BQfY9wwjVShQVpgbMH16X8BUgLpATy0KryAAAAAElFTkSuQmCC'); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="data layer with nodes"
        title=""
        src="/static/577b8e2bf994db9c7f6b2370764ce93d/39c09/data-layer-with-nodes.png"
        srcset="/static/577b8e2bf994db9c7f6b2370764ce93d/680fe/data-layer-with-nodes.png 156w,
/static/577b8e2bf994db9c7f6b2370764ce93d/17474/data-layer-with-nodes.png 312w,
/static/577b8e2bf994db9c7f6b2370764ce93d/39c09/data-layer-with-nodes.png 624w,
/static/577b8e2bf994db9c7f6b2370764ce93d/6d2da/data-layer-with-nodes.png 936w,
/static/577b8e2bf994db9c7f6b2370764ce93d/5a791/data-layer-with-nodes.png 1248w,
/static/577b8e2bf994db9c7f6b2370764ce93d/5df5d/data-layer-with-nodes.png 1572w"
        sizes="(max-width: 624px) 100vw, 624px"
        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
        loading="lazy"
        decoding="async"
      />
  </a>
    </span></span>
<p>继续配置 <span><code class="language-text">gatsby-config.ts</code></span> 如下：</p>
<span><div class="gatsby-highlight" data-language="ts"><pre class="language-ts"><code class="language-ts"><span class="token keyword">import</span> remarkGfm <span class="token keyword">from</span> <span class="token string">"remark-gfm"</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> config<span class="token operator">:</span> GatsbyConfig <span class="token operator">=</span> <span class="token punctuation">{</span>
  plugins<span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token punctuation">{</span>
      resolve<span class="token operator">:</span> <span class="token string">"gatsby-source-filesystem"</span><span class="token punctuation">,</span>
      <span class="token comment">// ...</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span>
      resolve<span class="token operator">:</span> <span class="token string">"gatsby-plugin-mdx"</span><span class="token punctuation">,</span>
      options<span class="token operator">:</span> <span class="token punctuation">{</span>
        gatsbyRemarkPlugins<span class="token operator">:</span> <span class="token punctuation">[</span>
          <span class="token comment">// 添加代码块高亮</span>
          <span class="token string">"gatsby-remark-prismjs"</span><span class="token punctuation">,</span>
        <span class="token punctuation">]</span><span class="token punctuation">,</span>
        mdxOptions<span class="token operator">:</span> <span class="token punctuation">{</span>
          remarkPlugins<span class="token operator">:</span> <span class="token punctuation">[</span>
            <span class="token comment">// 添加对 GitHub flavored markdown (GFM) 格式的支持</span>
            remarkGfm<span class="token punctuation">,</span>
          <span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre></div></span>
<p>值得一提的是，由于 MDX 的语法与 Markdown 不同，它默认仅支持 CommonMark 格式，而某些非标准的 Markdown 功能如表格，需要单独配置插件启用。在上面的配置项里，笔者就引入了 <span><code class="language-text">remark-gfm</code></span> 插件，它使得 <span><code class="language-text">gatsby-plugin-mdx</code></span> 能够解析 GFM 格式的语法。但是由于<a href="https://github.com/gatsbyjs/gatsby/discussions/36406" target="_blank" rel="noreferrer">兼容性问题</a>，经测试，目前的 <span><code class="language-text">gatsby-plugin-mdx@5.14.0</code></span> 只能搭配旧版本的 <span><code class="language-text">remark-gfm@^1.0.0</code></span> 使用，不过也足够了。</p>
<p>官方教程在博客的 Frontmatter 中添加了 <span><code class="language-text">slug</code></span> 属性来方便后续生成路由，但笔者更喜好 Hexo 那种文件路径驱动路由生成的模式。为此，可以在 <span><code class="language-text">gatsby-node.ts</code></span> 中导出 <span><code class="language-text">onCreateNode()</code></span> 方法，对于每一个 MDX 节点，根据文件路径生成 <span><code class="language-text">slug</code></span> 属性：</p>
<span><div class="gatsby-highlight" data-language="ts"><pre class="language-ts"><code class="language-ts"><span class="token keyword">import</span> <span class="token punctuation">{</span> <span class="token keyword">type</span> <span class="token class-name">CreateNodeArgs</span> <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">"gatsby"</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token function-variable function">onCreateNode</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">{</span> node<span class="token punctuation">,</span> actions <span class="token punctuation">}</span><span class="token operator">:</span> CreateNodeArgs<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">{</span> createNodeField <span class="token punctuation">}</span> <span class="token operator">=</span> actions<span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>node<span class="token punctuation">.</span>internal<span class="token punctuation">.</span>type <span class="token operator">===</span> <span class="token string">"Mdx"</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">createNodeField</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      node<span class="token punctuation">,</span>
      name<span class="token operator">:</span> <span class="token string">"slug"</span><span class="token punctuation">,</span>
      value<span class="token operator">:</span> <span class="token function">parseFilePathToPostSlug</span><span class="token punctuation">(</span><span class="token function">String</span><span class="token punctuation">(</span>node<span class="token punctuation">.</span>internal<span class="token punctuation">.</span>contentFilePath<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre></div></span>
<p>假设撰写了如下的博客文章：</p>
<span><div class="gatsby-highlight" data-language="md"><pre class="language-md"><code class="language-md"><span class="token front-matter-block"><span class="token punctuation">---</span>
<span class="token front-matter yaml language-yaml">title: 从同步 QQ 空间说说到前端呈现，我都做了些啥
date: 2024-10-17
updated: 2024-10-17
timeliness: false
categories:
  - 全栈开发
tags:
  - React
  - TypeScript
  - Node
  - ffmpeg</span>
<span class="token punctuation">---</span></span>

最近在捣腾我的 Timeline 时间线项目，希望将我在不同平台上的发言和活跃记录同步过来，在独立的站点上按照创建时间倒序呈现。

...</code></pre></div></span>
<p>访问本地的 GraphQL IDE 界面，查询到的 MDX 节点结果如下：</p>
<span><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 624px; "
    >
      <a
    class="gatsby-resp-image-link"
    href="/static/c14cf24377cf3d19da98a9533309e740/7a626/query-mdx-nodes.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
    <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 48.71794871794871%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAAAsTAAALEwEAmpwYAAABqUlEQVR42o2R626bUBCE8yKVjMFuCJirL2AuMcaAMXeaWJHaP636/q8wHY5TKWqaqj9Gu1rpfGd2507WY8hGgrkeCckaqxYKfVL3cMwUnT9Ato5QnRRLVsU8YsG6tFL2CT7bJzhRB9MvcSevYszdHLM15Wail/iBYsRQrQiq8QiXs+BQIUp7nIoeQzuiuvQ4nzu09Yim6tG2z+ifvxNIVwv3jLmdYmYeIK0iSK8OZT3E7CGgkwN6Qr5eX/DtekXfDALa1AO6ZiSUlcAvLz8nYAjFyrBwCkhcUSLgtybYjLMFXRrbHHY0crUB5i6Hvslxz41UalrZ9C+on34QqAUCtlxf3gGlN0CNJ7GDFl4yYkW45RX8pBDgh3UGJ6jQCCBXVqyTOLSk+v8A8lHY8JY1XL/ANiwFVCNQewtUGIo8pWYzECb+d2AsHK73JcKkgcr+3rmt+87hBBSPtVsYHznUNxmMoId3fEKSNSiY8Clv4ceVANr7V+CfgI+A5q6AFfbYPnbwogrh4aZNUGJFl5PD+v+BMe92huldoHs19F0Jm/dzOJs09W5YC+Av1shKSXuzIpsAAAAASUVORK5CYII='); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="query mdx nodes"
        title=""
        src="/static/c14cf24377cf3d19da98a9533309e740/39c09/query-mdx-nodes.png"
        srcset="/static/c14cf24377cf3d19da98a9533309e740/680fe/query-mdx-nodes.png 156w,
/static/c14cf24377cf3d19da98a9533309e740/17474/query-mdx-nodes.png 312w,
/static/c14cf24377cf3d19da98a9533309e740/39c09/query-mdx-nodes.png 624w,
/static/c14cf24377cf3d19da98a9533309e740/6d2da/query-mdx-nodes.png 936w,
/static/c14cf24377cf3d19da98a9533309e740/5a791/query-mdx-nodes.png 1248w,
/static/c14cf24377cf3d19da98a9533309e740/7a626/query-mdx-nodes.png 2165w"
        sizes="(max-width: 624px) 100vw, 624px"
        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
        loading="lazy"
        decoding="async"
      />
  </a>
    </span></span>
<p>截止目前，笔者完成了“解析数据源到数据层”这一阶段的工作，接下来就需要在组件读取这些 MDX 节点数据并展示了。</p>
<h3>渲染博客</h3>
<p>Gatsby 的 GraphQL 数据层是它区别于其它前端框架的重要特性，尽管最终构建的产物仍是静态的前端页面，但在开发的过程中引入了这样的类似数据库的概念，体验仿似自己与自己握手，自己同自己进行数据传递。</p>
<p>如果想在 React 组件里消费数据层里准备好的数据，就需要编写对应的 GraphQL 查询代码：</p>
<span><div class="gatsby-highlight" data-language="ts"><pre class="language-ts"><code class="language-ts"><span class="token comment">// src/hooks/useAllMdx.ts</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> graphql<span class="token punctuation">,</span> useStaticQuery <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">"gatsby"</span><span class="token punctuation">;</span>

<span class="token keyword">interface</span> <span class="token class-name">MdxNode</span> <span class="token punctuation">{</span>
  excerpt<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
  fields<span class="token operator">:</span> <span class="token punctuation">{</span>
    slug<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
  frontmatter<span class="token operator">:</span> <span class="token punctuation">{</span>
    categories<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    tags<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    title<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
    date<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
    updated<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token function-variable function">useAllMdx</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">{</span>
    allMdx<span class="token operator">:</span> <span class="token punctuation">{</span> nodes<span class="token operator">:</span> posts <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token generic-function"><span class="token function">useStaticQuery</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token punctuation">{</span>
    allMdx<span class="token operator">:</span> <span class="token punctuation">{</span> nodes<span class="token operator">:</span> MdxNode<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token operator">></span></span></span><span class="token punctuation">(</span>graphql<span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">
    query {
      allMdx(sort: { frontmatter: { date: DESC } }) {
        nodes {
          excerpt
          fields {
            slug
          }
          frontmatter {
            categories
            tags
            title
            date
            updated
          }
        }
      }
    }
  </span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">return</span> posts<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> useAllMdx<span class="token punctuation">;</span></code></pre></div></span>
<p>一个 React 组件里最多只能有 <span><code class="language-text">useStaticQuery()</code></span> 方法，如果您想要查询多条不同数据，要么把查询代码写到一起，要么就新建一个钩子方法（推荐）。对于全局都会使用到的数据，可以分门别类放到不同的钩子方法里，例如网站的 Metadata，就可以把查询代码放在 <span><code class="language-text">src/hooks/useSiteMetadata.ts</code></span> 里。</p>
<p>现在，笔者需要根据博客的文件路径，自动生成访问路由，例如对于博客文件 <span><code class="language-text">path/to/this-is-a-blog.mdx</code></span>，可以通过路由 <span><code class="language-text">/posts/this-is-a-blog</code></span> 访问到，该怎么实现呢？官方提供了多种方案，这里笔者选择了更符合自己喜好的，在 <span><code class="language-text">gatsby-node.ts</code></span> 文件里导出 <span><code class="language-text">createPages()</code></span> 方法的方案，它能够以编程的方式自定义生成路由，拥有相当大的自由度：</p>
<span><div class="gatsby-highlight" data-language="ts"><pre class="language-ts"><code class="language-ts"><span class="token keyword">import</span> <span class="token punctuation">{</span> <span class="token keyword">type</span> <span class="token class-name">CreatePagesArgs</span> <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">"gatsby"</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> path <span class="token keyword">from</span> <span class="token string">"path"</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> postTemplate <span class="token operator">=</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span><span class="token string">"./src/templates/post.tsx"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token function-variable function">createPages</span> <span class="token operator">=</span> <span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">{</span>
  actions<span class="token punctuation">,</span>
  graphql<span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token operator">:</span> CreatePagesArgs<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">{</span> data <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token generic-function"><span class="token function">graphql</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token punctuation">{</span>
    allMdx<span class="token operator">:</span> <span class="token punctuation">{</span>
      nodes<span class="token operator">:</span> MdxNode<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token operator">></span></span></span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">
    query {
      allMdx(
        sort: { frontmatter: { date: DESC } }
        filter: {
          internal: {
            contentFilePath: { regex: "//blog/posts/|/blog/about-me.mdx/" }
          }
        }
      ) {
        nodes {
          fields {
            slug
          }
          id
          internal {
            contentFilePath
          }
        }
      }
    }
  </span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  data<span class="token operator">?.</span>allMdx<span class="token punctuation">.</span>nodes<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span>node<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> slug <span class="token operator">=</span> node<span class="token punctuation">.</span>fields<span class="token punctuation">.</span>slug<span class="token punctuation">;</span>
    <span class="token keyword">const</span> path <span class="token operator">=</span> slug <span class="token operator">===</span> <span class="token string">"about-me"</span> <span class="token operator">?</span> <span class="token string">"/about-me"</span> <span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">/posts/</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>slug<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>

    actions<span class="token punctuation">.</span><span class="token function">createPage</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      path<span class="token punctuation">,</span>
      component<span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>postTemplate<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">?__contentFilePath=</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>node<span class="token punctuation">.</span>internal<span class="token punctuation">.</span>contentFilePath<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span>
      context<span class="token operator">:</span> <span class="token punctuation">{</span>
        id<span class="token operator">:</span> node<span class="token punctuation">.</span>id<span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre></div></span>
<p>笔者就根据博客的路径，单独配置了“关于我”页面的路由。此外，笔者读取了 <span><code class="language-text">src/templates/post.tsx</code></span> 文件作为生成路由的页面模板，并按照 <span><code class="language-text">gatsby-plugin-mdx</code></span> 推荐的方式，将 MDX 节点的文件路径作为了查询参数 <span><code class="language-text">__contentFilePath</code></span> 的值，这样模板文件的 <span><code class="language-text">props.children</code></span> 将自动被替换为 MDX 节点包含内容的解析结果。另外，笔者向组件传递了 MDX 节点 <span><code class="language-text">id</code></span> 作为上下文，为模板文件查询 MDX 节点详细信息提供了参数。</p>
<p>下面，编写模板文件 <span><code class="language-text">src/templates/post.tsx</code></span> 即可实现博客页面的展示了：</p>
<span><div class="gatsby-highlight" data-language="tsx"><pre class="language-tsx"><code class="language-tsx"><span class="token keyword">import</span> <span class="token punctuation">{</span> MDXProvider <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">"@mdx-js/react"</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> graphql<span class="token punctuation">,</span> <span class="token keyword">type</span> <span class="token class-name">PageProps</span> <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">"gatsby"</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token operator">*</span> <span class="token keyword">as</span> React <span class="token keyword">from</span> <span class="token string">"react"</span><span class="token punctuation">;</span>

<span class="token keyword">type</span> <span class="token class-name">PostPageData</span> <span class="token operator">=</span> <span class="token punctuation">{</span>
  mdx<span class="token operator">:</span> Pick<span class="token operator">&lt;</span>MdxNode<span class="token punctuation">,</span> <span class="token string">"frontmatter"</span><span class="token operator">></span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">type</span> <span class="token class-name">PostPageContext</span> <span class="token operator">=</span> Pick<span class="token operator">&lt;</span>MdxNode<span class="token punctuation">,</span> <span class="token string">"id"</span><span class="token operator">></span><span class="token punctuation">;</span>

<span class="token keyword">const</span> PostTemplate<span class="token operator">:</span> React<span class="token punctuation">.</span><span class="token constant">FC</span><span class="token operator">&lt;</span>PageProps<span class="token operator">&lt;</span>PostPageData<span class="token punctuation">,</span> PostPageContext<span class="token operator">>></span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">{</span>
  children<span class="token punctuation">,</span>
  data<span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">{</span>
    mdx<span class="token operator">:</span> <span class="token punctuation">{</span>
      frontmatter<span class="token operator">:</span> <span class="token punctuation">{</span> title<span class="token punctuation">,</span> date<span class="token punctuation">,</span> updated<span class="token punctuation">,</span> categories<span class="token punctuation">,</span> tags <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span> <span class="token operator">=</span> data<span class="token punctuation">;</span>

  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">></span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span><span class="token punctuation">></span></span><span class="token punctuation">{</span>title<span class="token punctuation">}</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">></span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>article</span><span class="token punctuation">></span></span><span class="token plain-text">
        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">MDXProvider</span></span><span class="token punctuation">></span></span><span class="token punctuation">{</span>children<span class="token punctuation">}</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token class-name">MDXProvider</span></span><span class="token punctuation">></span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>article</span><span class="token punctuation">></span></span><span class="token plain-text">
    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">const</span> query <span class="token operator">=</span> graphql<span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">
  query ($id: String!) {
    mdx(id: { eq: $id }) {
      frontmatter {
        categories
        tags
        title
        date
        updated
      }
    }
  }
</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> PostTemplate<span class="token punctuation">;</span></code></pre></div></span>
<p>通过上面导出的 <span><code class="language-text">query</code></span> 静态查询字符串，Gatsby 将查询数据层里 <span><code class="language-text">mdx.id === props.pageContext.id</code></span> 的 MDX 节点的指定属性，并把结果传递给 React 组件的 <span><code class="language-text">props.data</code></span>。</p>
<p>这样，“组件从数据层查询”这一阶段的工作也完成了，剩下的就是慢慢优化页面逻辑和展示效果了！</p>
<h3>添加自定义组件</h3>
<p>MDX 格式的博客相比 MD 格式的最大优势在于能够使用自定义的 React 组件：</p>
<span><div class="gatsby-highlight" data-language="tsx"><pre class="language-tsx"><code class="language-tsx"><span class="token keyword">import</span> <span class="token punctuation">{</span> <span class="token keyword">type</span> <span class="token class-name">MDXProps</span> <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">"mdx/types"</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> Card <span class="token keyword">from</span> <span class="token string">"path/to/components/card"</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> components<span class="token operator">:</span> MDXProps<span class="token punctuation">[</span><span class="token string">"components"</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span>
  Card<span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> <span class="token function-variable function">PostTemplate</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">{</span> children <span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>article</span><span class="token punctuation">></span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">MDXProvider</span></span> <span class="token attr-name">components</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>components<span class="token punctuation">}</span></span><span class="token punctuation">></span></span><span class="token punctuation">{</span>children<span class="token punctuation">}</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token class-name">MDXProvider</span></span><span class="token punctuation">></span></span><span class="token plain-text">
    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>article</span><span class="token punctuation">></span></span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre></div></span>
<p>现在，在编写 MDX 博客文件的时候，就可以像使用 JSX 一样使用 <span><code class="language-text">&lt;Card></code></span> 组件了！</p>
<span><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 624px; "
    >
      <a
    class="gatsby-resp-image-link"
    href="/static/978b22fece05e0e70a27935928fa8ea9/59000/card.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
    <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 37.17948717948718%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAYAAAAIy204AAAACXBIWXMAAAsTAAALEwEAmpwYAAABLElEQVR42n2RSW/CMBCF+QFIWchiZ1EUIg4cEqBZCMoCBE78i0a99dD/f3r1TKmFVKmHT7bG4+f3xgvXdbHdbtG2LaZpQpHn6Psep9MJt9sN9/sduap1Xcc9RBiG8DwPvu//YUEHcRxDCMFNUkqkacqs12tkWYYkSXSNCIKA+14RChYkISEFrpcr5nlGW5ZY2TZM09RYlqVXwzBgq3PCcRyGjahHtKAMJMd8PB5K+IJhGDgaxTwejzgcDno9n89cp5FUVYWiKDiBFvSfgqVyRpd2ux32+z031nXNF5um4XMSHMeRH29UL40kUuPi2K8OadN9faD9fIexXOpI1m/kZ1zbUqNQkU3jp+asVqBP9RRkyhfkUImR+qYpsaneIMMAQRz9Q6z3MgpfiNjhN59yxQs9gm7xAAAAAElFTkSuQmCC'); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="card"
        title=""
        src="/static/978b22fece05e0e70a27935928fa8ea9/39c09/card.png"
        srcset="/static/978b22fece05e0e70a27935928fa8ea9/680fe/card.png 156w,
/static/978b22fece05e0e70a27935928fa8ea9/17474/card.png 312w,
/static/978b22fece05e0e70a27935928fa8ea9/39c09/card.png 624w,
/static/978b22fece05e0e70a27935928fa8ea9/59000/card.png 917w"
        sizes="(max-width: 624px) 100vw, 624px"
        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
        loading="lazy"
        decoding="async"
      />
  </a>
    </span></span>
<p>另外，还可以自定义现有标签渲染的结果。例如想要为图片文件添加 FancyBox 的支持，可以编写代码如下：</p>
<span><div class="gatsby-highlight" data-language="tsx"><pre class="language-tsx"><code class="language-tsx"><span class="token keyword">import</span> <span class="token punctuation">{</span> Fancybox <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">"@fancyapps/ui"</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> <span class="token function-variable function">FancyBoxImage</span> <span class="token operator">=</span> <span class="token punctuation">(</span>props<span class="token operator">:</span> <span class="token punctuation">{</span> alt<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span> src<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">string</span> <span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">{</span>
    alt <span class="token operator">=</span> <span class="token string">"The author is too lazy to give an alt"</span><span class="token punctuation">,</span>
    src<span class="token punctuation">,</span>
    <span class="token operator">...</span>restProps
  <span class="token punctuation">}</span> <span class="token operator">=</span> props<span class="token punctuation">;</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>src<span class="token punctuation">}</span></span> <span class="token attr-name">data-fancybox</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>gallery<span class="token punctuation">"</span></span> <span class="token attr-name">data-caption</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>alt<span class="token punctuation">}</span></span><span class="token punctuation">></span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>img</span> <span class="token attr-name">src</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>src<span class="token punctuation">}</span></span> <span class="token attr-name">alt</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>alt<span class="token punctuation">}</span></span> <span class="token spread"><span class="token punctuation">{</span><span class="token operator">...</span>restProps<span class="token punctuation">}</span></span> <span class="token punctuation">/></span></span><span class="token plain-text">
    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">></span></span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> components<span class="token operator">:</span> MDXProps<span class="token punctuation">[</span><span class="token string">"components"</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span>
  img<span class="token operator">:</span> FancyBoxImage<span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> <span class="token function-variable function">PostTemplate</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">{</span> children <span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> articleRef <span class="token operator">=</span> React<span class="token punctuation">.</span><span class="token generic-function"><span class="token function">useRef</span><span class="token generic class-name"><span class="token operator">&lt;</span>HTMLElement<span class="token operator">></span></span></span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  React<span class="token punctuation">.</span><span class="token function">useEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
    <span class="token function">Fancybox</span><span class="token punctuation">.</span><span class="token function">bind</span><span class="token punctuation">(</span><span class="token string">"[data-fancybox]"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> Fancybox<span class="token punctuation">.</span><span class="token function">unbind</span><span class="token punctuation">(</span><span class="token string">"[data-fancybox]"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>article</span> <span class="token attr-name">ref</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>articleRef<span class="token punctuation">}</span></span><span class="token punctuation">></span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">MDXProvider</span></span> <span class="token attr-name">components</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>components<span class="token punctuation">}</span></span><span class="token punctuation">></span></span><span class="token punctuation">{</span>children<span class="token punctuation">}</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token class-name">MDXProvider</span></span><span class="token punctuation">></span></span><span class="token plain-text">
    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>article</span><span class="token punctuation">></span></span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre></div></span>
<p>MDX 渲染得到的 <span><code class="language-text">&lt;img></code></span> 组件将自动被替换为 <span><code class="language-text">&lt;FancyBoxImage></code></span> 组件，随后正确地被 FancyBox 绑定。</p>
<h3>静态资源的访问与优化</h3>
<p>使用插件 <span><code class="language-text">gatsby-remark-images</code></span>，Gatsby 将自动压缩博客中使用到的本地图片，减少流量压力，同时生成占位图片，避免博客高度突然变化，提升阅读体验。处理后的图片资源将自动生成到 <span><code class="language-text">public</code></span> 的对应目录下，确保能被正确地访问。在 Gatsby 的最佳实践中，应当始终使用类似 <span><code class="language-text">gatsby-remark-images</code></span> 插件的方案来优化图片类型的静态资源。</p>
<p>结合插件 <span><code class="language-text">gatsby-plugin-mdx</code></span> 使用，可以配置如下：</p>
<span><div class="gatsby-highlight" data-language="ts"><pre class="language-ts"><code class="language-ts"><span class="token keyword">const</span> config<span class="token operator">:</span> GatsbyConfig <span class="token operator">=</span> <span class="token punctuation">{</span>
  plugins<span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token string">"gatsby-plugin-sharp"</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span>
      resolve<span class="token operator">:</span> <span class="token string">"gatsby-plugin-mdx"</span><span class="token punctuation">,</span>
      options<span class="token operator">:</span> <span class="token punctuation">{</span>
        gatsbyRemarkPlugins<span class="token operator">:</span> <span class="token punctuation">[</span>
          <span class="token punctuation">{</span>
            resolve<span class="token operator">:</span> <span class="token string">"gatsby-remark-images"</span><span class="token punctuation">,</span>
            options<span class="token operator">:</span> <span class="token punctuation">{</span>
              maxWidth<span class="token operator">:</span> <span class="token number">624</span><span class="token punctuation">,</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
          <span class="token punctuation">}</span><span class="token punctuation">,</span>
          <span class="token string">"gatsby-remark-copy-linked-files"</span><span class="token punctuation">,</span>
        <span class="token punctuation">]</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre></div></span>
<p>其中，<span><code class="language-text">gatsby-plugin-sharp</code></span> 是插件 <span><code class="language-text">gatsby-remark-images</code></span> 的必要依赖，需要添加到插件列表中。</p>
<p>需要留意的是：插件 <span><code class="language-text">gatsby-remark-images</code></span> 仅支持压缩、处理部分的图片格式如 <span><code class="language-text">.jpeg</code></span>。其它的格式如 <span><code class="language-text">.gif</code></span> 则需要插件 <span><code class="language-text">gatsby-remark-copy-linked-files</code></span> 帮助，原封不动地移动到 <span><code class="language-text">public</code></span> 里的对应目录。协同使用这两个插件即可达成最好的静态资源访问效果。</p>
<p>由于 <span><code class="language-text">gatsby-remark-images</code></span> 会相应地封装 MDX 渲染结果里的 <span><code class="language-text">&lt;img></code></span> 标签，为了兼容 FancyBox 能力，可以编写 <span><code class="language-text">useEffect()</code></span> 钩子方法如下：</p>
<span><div class="gatsby-highlight" data-language="tsx"><pre class="language-tsx"><code class="language-tsx"><span class="token keyword">const</span> <span class="token function-variable function">PostTemplate</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">{</span> children <span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> articleRef <span class="token operator">=</span> React<span class="token punctuation">.</span><span class="token generic-function"><span class="token function">useRef</span><span class="token generic class-name"><span class="token operator">&lt;</span>HTMLElement<span class="token operator">></span></span></span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  React<span class="token punctuation">.</span><span class="token function">useEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> optimizedImageLinks <span class="token operator">=</span>
      articleRef<span class="token punctuation">.</span>current<span class="token operator">?.</span><span class="token generic-function"><span class="token function">querySelectorAll</span><span class="token generic class-name"><span class="token operator">&lt;</span>HTMLLinkElement<span class="token operator">></span></span></span><span class="token punctuation">(</span>
        <span class="token string">"a.gatsby-resp-image-link"</span><span class="token punctuation">,</span>
      <span class="token punctuation">)</span><span class="token punctuation">;</span>
    optimizedImageLinks<span class="token operator">?.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span>link<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
      <span class="token keyword">const</span> image <span class="token operator">=</span> link<span class="token punctuation">.</span>children<span class="token punctuation">.</span><span class="token function">item</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token keyword">as</span> HTMLImageElement<span class="token punctuation">;</span>
      link<span class="token punctuation">.</span><span class="token function">setAttribute</span><span class="token punctuation">(</span><span class="token string">"data-fancybox"</span><span class="token punctuation">,</span> <span class="token string">"gallery"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      link<span class="token punctuation">.</span><span class="token function">setAttribute</span><span class="token punctuation">(</span><span class="token string">"data-caption"</span><span class="token punctuation">,</span> image<span class="token punctuation">.</span>alt<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token function">Fancybox</span><span class="token punctuation">.</span><span class="token function">bind</span><span class="token punctuation">(</span><span class="token string">"[data-fancybox]"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> Fancybox<span class="token punctuation">.</span><span class="token function">unbind</span><span class="token punctuation">(</span><span class="token string">"[data-fancybox]"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>article</span> <span class="token attr-name">ref</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>articleRef<span class="token punctuation">}</span></span><span class="token punctuation">></span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">MDXProvider</span></span> <span class="token attr-name">components</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>components<span class="token punctuation">}</span></span><span class="token punctuation">></span></span><span class="token punctuation">{</span>children<span class="token punctuation">}</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token class-name">MDXProvider</span></span><span class="token punctuation">></span></span><span class="token plain-text">
    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>article</span><span class="token punctuation">></span></span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre></div></span>
<h2>博客搜索</h2>
<p>笔者基于 Algolia 实现博客搜索的能力，插件 <a href="https://www.gatsbyjs.com/plugins/gatsby-plugin-algolia/" target="_blank" rel="noreferrer"><span><code class="language-text">gatsby-plugin-algolia</code></span></a> 能帮助项目快速实现索引数据并上传的功能。</p>
<p>在 Algolia 控制台创建索引并获取密钥等的操作不再冗述，将这些值塞到环境变量里即可被 Gatsby 访问：</p>
<span><div class="gatsby-highlight" data-language="bash"><pre class="language-bash"><code class="language-bash"><span class="token comment"># 包含 GATSBY_ 前缀的环境变量将暴露到客户端环境中</span>
<span class="token comment"># 后续将用到下面三个变量实现客户端检索功能</span>
<span class="token assign-left variable">GATSBY_ALGOLIA_APP_ID</span><span class="token operator">=</span>YOUR_ALGOLIA_APP_ID
<span class="token assign-left variable">GATSBY_ALGOLIA_API_PUBLIC_KEY</span><span class="token operator">=</span>YOUR_ALGOLIA_API_PUBLIC_KEY
<span class="token assign-left variable">GATSBY_ALGOLIA_INDEX_NAME</span><span class="token operator">=</span>YOUR_ALGOLIA_INDEX_NAME
<span class="token comment"># 用于上传数据等的 Algolia 管理秘钥切勿添加 GATSBY_ 前缀</span>
<span class="token assign-left variable">ALGOLIA_API_KEY</span><span class="token operator">=</span>YOUR_ALGOLIA_API_PRIVATE_KEY</code></pre></div></span>
<p>为了上传用于检索的博客元数据到 Algolia，可以像这么配置 <span><code class="language-text">gatsby-config.ts</code></span>：</p>
<span><div class="gatsby-highlight" data-language="ts"><pre class="language-ts"><code class="language-ts"><span class="token keyword">import</span> dotenv <span class="token keyword">from</span> <span class="token string">"dotenv"</span><span class="token punctuation">;</span>

dotenv<span class="token punctuation">.</span><span class="token function">config</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  path<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">".env"</span><span class="token punctuation">,</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">.env.</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">NODE_ENV</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> config<span class="token operator">:</span> GatsbyConfig <span class="token operator">=</span> <span class="token punctuation">{</span>
  plugins<span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token punctuation">{</span>
      <span class="token comment">// ... 其它的插件</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span>
      <span class="token comment">// 应当将 gatsby-plugin-algolia 插件放到列表的最后</span>
      <span class="token comment">// 确保 GraphQL 查询到的结果是经过其它插件处理后的最终结果</span>
      resolve<span class="token operator">:</span> <span class="token string">"gatsby-plugin-algolia"</span><span class="token punctuation">,</span>
      options<span class="token operator">:</span> <span class="token punctuation">{</span>
        appId<span class="token operator">:</span> process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">GATSBY_ALGOLIA_APP_ID</span><span class="token punctuation">,</span>
        apiKey<span class="token operator">:</span> process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">ALGOLIA_API_KEY</span><span class="token punctuation">,</span>
        indexName<span class="token operator">:</span> process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">GATSBY_ALGOLIA_INDEX_NAME</span><span class="token punctuation">,</span>
        queries<span class="token operator">:</span> <span class="token punctuation">[</span>
          <span class="token punctuation">{</span>
            query<span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">
              query {
                allMdx(
                  filter: {
                    internal: {
                      contentFilePath: { regex: "//blog/posts//" }
                    }
                  }
                ) {
                  nodes {
                    excerpt(pruneLength: 200)
                    fields {
                      slug
                    }
                    frontmatter {
                      categories
                      tags
                      title
                      date
                      updated
                      timeliness
                    }
                    id
                    internal {
                      contentDigest
                    }
                  }
                }
              }</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span>
            <span class="token function-variable function">transformer</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">{</span>
              data<span class="token punctuation">,</span>
            <span class="token punctuation">}</span><span class="token operator">:</span> <span class="token punctuation">{</span>
              data<span class="token operator">:</span> <span class="token punctuation">{</span>
                allMdx<span class="token operator">:</span> <span class="token punctuation">{</span>
                  nodes<span class="token operator">:</span> MdxNode<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span><span class="token punctuation">;</span>
              <span class="token punctuation">}</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token operator">=></span> data<span class="token punctuation">.</span>allMdx<span class="token punctuation">.</span>nodes<span class="token punctuation">,</span>
          <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">]</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre></div></span>
<p>插件 <span><code class="language-text">gatsby-plugin-algolia</code></span> 需要一个包含博客元数据的数组以执行上传操作，而 GraphQL 查询的结果是一个形如 <span><code class="language-text">{ addMdx: { nodes: MdxNode[] }}</code></span> 的对象，因此要使用插件提供的 <span><code class="language-text">transformer()</code></span> 方法，返回里面的 <span><code class="language-text">nodes</code></span> 数组。</p>
<p>为了确保博客在索引里的唯一性，并确保索引里的数据始终最新，在 GraphQL 查询的时候必须提供 <span><code class="language-text">id</code></span> 和 <span><code class="language-text">internal.contentDigest</code></span>。</p>
<p>这样，当执行构建操作时，插件将自动把查询得到的博客元数据上传到指定的 Algolia 索引中去。登录 Algolia 控制台，即可查看上传的结果啦：</p>
<span><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 624px; "
    >
      <a
    class="gatsby-resp-image-link"
    href="/static/b9a90ce7a2905fce114512d4d6c78e1e/8733b/algolia-index-item.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
    <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 61.53846153846154%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAYAAABiDJ37AAAACXBIWXMAAAsTAAALEwEAmpwYAAABc0lEQVR42qWS627CMAyF+/6PuDGuY6XlVkqTNGmTMx+HIn4whDRLVuI0/mKfurDWwxqHEEYYG3C9WhiJxzFiGOJ9nfaTM7Z638G5oO79gIKgvueBV+/lkLH3QfYjXJ+Tgzj31uWVeRPo0lo5G/SsGAYCCevlxT7DJSbQ9lK1S4hj0qqMwDqTdGU15na/aSzYaQhS4dRCSrhbkqBtO/AxPtKKDO01CMCj65xUHhBjRJR7MaabDHktMuyBRqD4MI6auFrVWG8OmG8clpsG2+1R4j1W6z12uwZV1WjbbJePKPCZUQJqulhWmH2VmC9KfAtsta7x8fmDz1mp3+aLSmG0e4XPLKWoOpblCVXdoK4v2O9bHA4tyt0Zx+NVNaR2E+PPCkdp93g6a5UUndq1HA8bVHgmUt/JJ8leAo2x8CHPGceCzn1zMfpjCM7+BpBmjEHweT6NYaWDroTpuPg8yI/5L4HvGseGYO9vf5ka8PA/zrbp/Mu/ivqrJqdvyOAAAAAASUVORK5CYII='); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="algolia index item"
        title=""
        src="/static/b9a90ce7a2905fce114512d4d6c78e1e/39c09/algolia-index-item.png"
        srcset="/static/b9a90ce7a2905fce114512d4d6c78e1e/680fe/algolia-index-item.png 156w,
/static/b9a90ce7a2905fce114512d4d6c78e1e/17474/algolia-index-item.png 312w,
/static/b9a90ce7a2905fce114512d4d6c78e1e/39c09/algolia-index-item.png 624w,
/static/b9a90ce7a2905fce114512d4d6c78e1e/6d2da/algolia-index-item.png 936w,
/static/b9a90ce7a2905fce114512d4d6c78e1e/5a791/algolia-index-item.png 1248w,
/static/b9a90ce7a2905fce114512d4d6c78e1e/8733b/algolia-index-item.png 1495w"
        sizes="(max-width: 624px) 100vw, 624px"
        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
        loading="lazy"
        decoding="async"
      />
  </a>
    </span></span>
<p>客户端搜索博客的功能可以基于 Algolia 提供的前端组件实现，笔者实现的一个简单的例子是：</p>
<span><div class="gatsby-highlight" data-language="tsx"><pre class="language-tsx"><code class="language-tsx"><span class="token keyword">import</span> <span class="token punctuation">{</span> liteClient <span class="token keyword">as</span> algoliasearch <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">"algoliasearch/lite"</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span>
  Configure<span class="token punctuation">,</span>
  Hits<span class="token punctuation">,</span>
  InstantSearch<span class="token punctuation">,</span>
  Pagination<span class="token punctuation">,</span>
  SearchBox<span class="token punctuation">,</span>
<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">"react-instantsearch"</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> Post <span class="token keyword">from</span> <span class="token string">"path/to/post"</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> searchClient <span class="token operator">=</span> <span class="token function">algoliasearch</span><span class="token punctuation">(</span>
  <span class="token function">String</span><span class="token punctuation">(</span>process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">GATSBY_ALGOLIA_APP_ID</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token function">String</span><span class="token punctuation">(</span>process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">GATSBY_ALGOLIA_API_PUBLIC_KEY</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> <span class="token function-variable function">Hit</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">{</span> hit <span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">Post</span></span> <span class="token attr-name">post</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>hit<span class="token punctuation">}</span></span> <span class="token punctuation">/></span></span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> <span class="token function-variable function">AlgoliaSearch</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">InstantSearch</span></span>
      <span class="token attr-name">insights</span>
      <span class="token attr-name">searchClient</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>searchClient<span class="token punctuation">}</span></span>
      <span class="token attr-name">indexName</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">GATSBY_ALGOLIA_INDEX_NAME</span><span class="token punctuation">}</span></span>
    <span class="token punctuation">></span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">Configure</span></span> <span class="token attr-name">hitsPerPage</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token number">10</span><span class="token punctuation">}</span></span> <span class="token punctuation">/></span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">SearchBox</span></span> <span class="token punctuation">/></span></span><span class="token plain-text">
      &lt;Hits&lt;AlgoliaPostItem> hitComponent=</span><span class="token punctuation">{</span>Hit<span class="token punctuation">}</span><span class="token plain-text"> />
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">Pagination</span></span> <span class="token punctuation">/></span></span><span class="token plain-text">
    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token class-name">InstantSearch</span></span><span class="token punctuation">></span></span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> AlgoliaSearch<span class="token punctuation">;</span></code></pre></div></span>
<p>这样，客户端的博客搜索能力就实现了：</p>
<span><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 624px; "
    >
      <a
    class="gatsby-resp-image-link"
    href="/static/70f0e1ff11fc4a56a7171d1438a51aa9/ecf19/algolia-search-item.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
    <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 84.61538461538461%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAARCAYAAADdRIy+AAAACXBIWXMAAAsTAAALEwEAmpwYAAACAklEQVR42q1U2W7iUAzNNwBZWEPKAAOBAalsIYBIgYJEGiqGpSAhIfWhH9CX/v2Za5eEULUjKvXhyPGNc+xjO1dKJBKoVqtoNBpsS6USyuXyp6hUKjBN8wzhl8omdD2DbDaLdDoNiQhHoxHW6zUcx0Gn00G3270CFmy7h7ZlI5//xQmSySSkeDwORVEQi8UuEI1G+VyWZfbJapoGir+EBlVVOZZ8iYLa7TbDMLIoFEzc3PwREqvCGiJ7ntuQy+WCxH6S9+d3q8gKSK1EZc5mMywWHlx3gednD29vI7y87Nifz+fcjs1mwz0mYkKxWMRvgUK+wHINw0AiLghTqRT6/T7u7hxBusJud4vXV1mQ9LFcbnF/P8F0OsV4PMZwOGTreZ6IXYj3S6xWK3Rtm5UEkgeDgQicYDIZ4+HhryB5wuPjWpCusN1ucTgcsN/v0ev1WMnxeGQiqpxIXddFrVbjXjJhs9lk2VSp4wxFgq5Yo1uePk2eYFkW95msLSqq1+u8Rq1WiwvKZDJnQuojSac9omeCrut85oMaH4lEePoEmQZy2gaCKgaWpKEQIU0tDH9dwqDsFBtA+Kp2PqP3QQ/J+Ql8m/Ciwg/VauppD79D6P8dPpH/HE74o5KvJvQH86XkE0dwOfwvkEC/FSEs9eN3VxNSIO0k3Xf+vvqWhhC+eWgo/wABDONIrY6JVQAAAABJRU5ErkJggg=='); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="algolia search item"
        title=""
        src="/static/70f0e1ff11fc4a56a7171d1438a51aa9/39c09/algolia-search-item.png"
        srcset="/static/70f0e1ff11fc4a56a7171d1438a51aa9/680fe/algolia-search-item.png 156w,
/static/70f0e1ff11fc4a56a7171d1438a51aa9/17474/algolia-search-item.png 312w,
/static/70f0e1ff11fc4a56a7171d1438a51aa9/39c09/algolia-search-item.png 624w,
/static/70f0e1ff11fc4a56a7171d1438a51aa9/6d2da/algolia-search-item.png 936w,
/static/70f0e1ff11fc4a56a7171d1438a51aa9/ecf19/algolia-search-item.png 948w"
        sizes="(max-width: 624px) 100vw, 624px"
        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
        loading="lazy"
        decoding="async"
      />
  </a>
    </span></span>
<h2>路由切换体验优化</h2>
<p>有的时候切换路由可能需要几秒钟时间处理，用户看不到页面切换的结果可能会非常焦虑。为了缓解这种焦虑，在库 <span><code class="language-text">nprogress</code></span> 的帮助下，笔者添加了可视化的进度条。</p>
<p>这一切非常简单，只需要在 <span><code class="language-text">gatsby-browser.ts</code></span> 文件导出两个生命周期钩子方法即可：</p>
<span><div class="gatsby-highlight" data-language="ts"><pre class="language-ts"><code class="language-ts"><span class="token keyword">import</span> nProgress <span class="token keyword">from</span> <span class="token string">"nprogress"</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token function-variable function">onRouteUpdateDelayed</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
  nProgress<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token function-variable function">onRouteUpdate</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
  nProgress<span class="token punctuation">.</span><span class="token function">done</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre></div></span>
<p>上面的代码表示，当路由切换耗时大于 1 秒时，显示进度条。当路由切换完成时，隐藏进度条。</p>
<p>当然，别忘了引入 <span><code class="language-text">nprogress</code></span> 的样式文件，如果希望，还可以修改一下进度条的颜色。</p>
<h2>持续部署</h2>
<p>笔者基于 Github Workflow 实现项目的持续集成与持续部署，可以编写工作流文件 <span><code class="language-text">.github/workflows/deployment.yml</code></span> 如下：</p>
<span><div class="gatsby-highlight" data-language="yml"><pre class="language-yml"><code class="language-yml"><span class="token key atrule">name</span><span class="token punctuation">:</span> Blog System CI &amp; CD

<span class="token key atrule">on</span><span class="token punctuation">:</span>
  <span class="token key atrule">push</span><span class="token punctuation">:</span>
    <span class="token key atrule">branches</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> main

<span class="token key atrule">jobs</span><span class="token punctuation">:</span>
  <span class="token key atrule">pages</span><span class="token punctuation">:</span>
    <span class="token key atrule">runs-on</span><span class="token punctuation">:</span> ubuntu<span class="token punctuation">-</span>latest

    <span class="token key atrule">steps</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> Checkout code
        <span class="token key atrule">uses</span><span class="token punctuation">:</span> actions/checkout@v4

      <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> Use Node.js 20.x
        <span class="token key atrule">uses</span><span class="token punctuation">:</span> actions/setup<span class="token punctuation">-</span>node@v4
        <span class="token key atrule">with</span><span class="token punctuation">:</span>
          <span class="token key atrule">node-version</span><span class="token punctuation">:</span> <span class="token number">20</span>
          <span class="token key atrule">cache</span><span class="token punctuation">:</span> <span class="token string">"yarn"</span>

      <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> Cache Yarn dependencies
        <span class="token key atrule">uses</span><span class="token punctuation">:</span> actions/cache@v4
        <span class="token key atrule">id</span><span class="token punctuation">:</span> yarn<span class="token punctuation">-</span>cache
        <span class="token key atrule">with</span><span class="token punctuation">:</span>
          <span class="token key atrule">path</span><span class="token punctuation">:</span> node_modules
          <span class="token key atrule">key</span><span class="token punctuation">:</span> $<span class="token punctuation">{</span><span class="token punctuation">{</span> runner.os <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">-</span>yarn<span class="token punctuation">-</span>$<span class="token punctuation">{</span><span class="token punctuation">{</span> hashFiles('<span class="token important">**/yarn.lock')</span> <span class="token punctuation">}</span><span class="token punctuation">}</span>
          <span class="token key atrule">restore-keys</span><span class="token punctuation">:</span> <span class="token punctuation">|</span><span class="token scalar string">
            ${{ runner.os }}-yarn-</span>

      <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> Install dependencies
        <span class="token key atrule">run</span><span class="token punctuation">:</span> yarn install <span class="token punctuation">-</span><span class="token punctuation">-</span>immutable

      <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> Build Gatsby
        <span class="token key atrule">run</span><span class="token punctuation">:</span> yarn build

      <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> Deploy
        <span class="token key atrule">uses</span><span class="token punctuation">:</span> peaceiris/actions<span class="token punctuation">-</span>gh<span class="token punctuation">-</span>pages@v4
        <span class="token key atrule">with</span><span class="token punctuation">:</span>
          <span class="token key atrule">personal_token</span><span class="token punctuation">:</span> $<span class="token punctuation">{</span><span class="token punctuation">{</span> secrets.PERSONAL_ACCESS_TOKEN <span class="token punctuation">}</span><span class="token punctuation">}</span> <span class="token comment"># 笔者将产物推送到了外部仓库，因此这里使用到了 Github 私人密钥</span>
          <span class="token key atrule">publish_dir</span><span class="token punctuation">:</span> ./public
          <span class="token key atrule">external_repository</span><span class="token punctuation">:</span> LolipopJ/LolipopJ.github.io
          <span class="token key atrule">publish_branch</span><span class="token punctuation">:</span> main</code></pre></div></span></article></div></div><footer class="flex h-footer flex-col justify-center gap-2 border-t border-foreground-tertiary bg-background-lighter px-16 print:hidden"><div class="flex flex-col gap-2 md:flex-row md:items-center"><span>Powered by<!-- --> <a href="https://www.gatsbyjs.com/" target="_blank" rel="noreferrer" class="item-link">Gatsby</a></span><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="rainbow" class="svg-inline--fa fa-rainbow hidden md:block" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 512"><path fill="currentColor" d="M320 96C178.6 96 64 210.6 64 352l0 96c0 17.7-14.3 32-32 32s-32-14.3-32-32l0-96C0 175.3 143.3 32 320 32s320 143.3 320 320l0 96c0 17.7-14.3 32-32 32s-32-14.3-32-32l0-96C576 210.6 461.4 96 320 96zm0 192c-35.3 0-64 28.7-64 64l0 96c0 17.7-14.3 32-32 32s-32-14.3-32-32l0-96c0-70.7 57.3-128 128-128s128 57.3 128 128l0 96c0 17.7-14.3 32-32 32s-32-14.3-32-32l0-96c0-35.3-28.7-64-64-64zM160 352l0 96c0 17.7-14.3 32-32 32s-32-14.3-32-32l0-96c0-123.7 100.3-224 224-224s224 100.3 224 224l0 96c0 17.7-14.3 32-32 32s-32-14.3-32-32l0-96c0-88.4-71.6-160-160-160s-160 71.6-160 160z"></path></svg><span>Inspired by<!-- --> <a href="https://thesis.priority.vision/" target="_blank" rel="noreferrer" class="item-link">Thesis</a></span></div><div class="flex flex-col gap-2 md:flex-row md:items-center"><a href="https://beian.miit.gov.cn/" target="_blank" rel="noreferrer">蜀ICP备 2024076241号</a><img src="/images/beian.png" alt="beian-icon" class="hidden size-5 md:block"/><a href="http://www.beian.gov.cn/portal/registerSystemInfo?recordcode=51010802001109" target="_blank" rel="noreferrer">京公网安备 <!-- -->51010802001109<!-- -->号</a></div><div class="my-3 w-full border border-foreground-tertiary"></div><div class="flex h-6 items-center justify-between"><span class="text-foreground-secondary">© <!-- -->2025<!-- --> <a href="https://github.com/LolipopJ" target="_blank" rel="noreferrer">Lolipop</a></span><div class="-mr-2 flex gap-2 text-xl"><a title="@LolipopJ" href="https://github.com/LolipopJ" target="_blank" rel="noreferrer" class="leading-none"><svg aria-hidden="true" focusable="false" data-prefix="fab" data-icon="github" class="svg-inline--fa fa-github item-selectable rounded-md p-2" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><path fill="currentColor" d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"></path></svg></a><a title="@lolipopj_703" href="https://steamcommunity.com/id/lolipopj_703" target="_blank" rel="noreferrer" class="leading-none"><svg aria-hidden="true" focusable="false" data-prefix="fab" data-icon="steam" class="svg-inline--fa fa-steam item-selectable rounded-md p-2" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><path fill="currentColor" d="M496 256c0 137-111.2 248-248.4 248-113.8 0-209.6-76.3-239-180.4l95.2 39.3c6.4 32.1 34.9 56.4 68.9 56.4 39.2 0 71.9-32.4 70.2-73.5l84.5-60.2c52.1 1.3 95.8-40.9 95.8-93.5 0-51.6-42-93.5-93.7-93.5s-93.7 42-93.7 93.5v1.2L176.6 279c-15.5-.9-30.7 3.4-43.5 12.1L0 236.1C10.2 108.4 117.1 8 247.6 8 384.8 8 496 119 496 256zM155.7 384.3l-30.5-12.6a52.79 52.79 0 0 0 27.2 25.8c26.9 11.2 57.8-1.6 69-28.4 5.4-13 5.5-27.3.1-40.3-5.4-13-15.5-23.2-28.5-28.6-12.9-5.4-26.7-5.2-38.9-.6l31.5 13c19.8 8.2 29.2 30.9 20.9 50.7-8.3 19.9-31 29.2-50.8 21zm173.8-129.9c-34.4 0-62.4-28-62.4-62.3s28-62.3 62.4-62.3 62.4 28 62.4 62.3-27.9 62.3-62.4 62.3zm.1-15.6c25.9 0 46.9-21 46.9-46.8 0-25.9-21-46.8-46.9-46.8s-46.9 21-46.9 46.8c.1 25.8 21.1 46.8 46.9 46.8z"></path></svg></a></div></div></footer><div class="hidden absolute inset-0 bg-neutral-900/80 backdrop-blur-sm lg:hidden print:hidden"></div></main><div class="absolute inset-0 z-30 bg-neutral-900/60 backdrop-blur-sm print:hidden hidden"><div class="flex h-[568px] max-w-2xl flex-col rounded-xl max-h-[calc(100vh-4rem)]] mx-auto mt-16 border border-foreground-tertiary bg-neutral-900/90"></div></div></div></div><div id="gatsby-announcer" style="position:absolute;top:0;width:1px;height:1px;padding:0;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;border:0" aria-live="assertive" aria-atomic="true"></div></div><script id="gatsby-script-loader">/*<![CDATA[*/window.pagePath="/posts/build-my-gatsby-blog/";/*]]>*/</script><!-- slice-start id="_gatsby-scripts-1" -->
          <script
            id="gatsby-chunk-mapping"
          >
            window.___chunkMapping="{\"app\":[\"/app-5463486eff8b3394a611.js\"],\"component---src-pages-404-tsx\":[\"/component---src-pages-404-tsx-0f89ab9641ee2883d8ef.js\"],\"component---src-pages-categories-tsx\":[\"/component---src-pages-categories-tsx-b2d7805cf32f9e5ff0c4.js\"],\"component---src-pages-index-tsx\":[\"/component---src-pages-index-tsx-f0e51fd78f14244ab910.js\"],\"component---src-pages-tags-tsx\":[\"/component---src-pages-tags-tsx-b3a78fcefb3a2fad0062.js\"],\"component---src-templates-post-list-tsx\":[\"/component---src-templates-post-list-tsx-cd42dada1f67bb37026c.js\"],\"component---src-templates-post-tsx-content-file-path-blog-about-me-mdx\":[\"/component---src-templates-post-tsx-content-file-path-blog-about-me-mdx-6755e6f7c490a3a10348.js\"],\"component---src-templates-post-tsx-content-file-path-blog-drafts-beatify-steam-personal-page-mdx\":[\"/component---src-templates-post-tsx-content-file-path-blog-drafts-beatify-steam-personal-page-mdx-09881576e4fb0071a612.js\"],\"component---src-templates-post-tsx-content-file-path-blog-drafts-connect-to-international-network-mdx\":[\"/component---src-templates-post-tsx-content-file-path-blog-drafts-connect-to-international-network-mdx-fe3216bf4760af9209fa.js\"],\"component---src-templates-post-tsx-content-file-path-blog-drafts-connect-to-my-mc-server-mdx\":[\"/component---src-templates-post-tsx-content-file-path-blog-drafts-connect-to-my-mc-server-mdx-8f87e02c540ba01b3942.js\"],\"component---src-templates-post-tsx-content-file-path-blog-drafts-ffxiv-global-mdx\":[\"/component---src-templates-post-tsx-content-file-path-blog-drafts-ffxiv-global-mdx-7d5d3f054faadd86fedc.js\"],\"component---src-templates-post-tsx-content-file-path-blog-posts-amap-import-vue-mdx\":[\"/component---src-templates-post-tsx-content-file-path-blog-posts-amap-import-vue-mdx-2d1218deca29ab9ee8ea.js\"],\"component---src-templates-post-tsx-content-file-path-blog-posts-antd-comp-garbled-characters-mdx\":[\"/component---src-templates-post-tsx-content-file-path-blog-posts-antd-comp-garbled-characters-mdx-7213254f4e06c47d79a4.js\"],\"component---src-templates-post-tsx-content-file-path-blog-posts-backup-mc-server-mdx\":[\"/component---src-templates-post-tsx-content-file-path-blog-posts-backup-mc-server-mdx-6ce634c6c44b4e0f24f7.js\"],\"component---src-templates-post-tsx-content-file-path-blog-posts-browser-behind-visit-url-mdx\":[\"/component---src-templates-post-tsx-content-file-path-blog-posts-browser-behind-visit-url-mdx-8d5bc5564e7c8e913c51.js\"],\"component---src-templates-post-tsx-content-file-path-blog-posts-build-my-gatsby-blog-mdx\":[\"/component---src-templates-post-tsx-content-file-path-blog-posts-build-my-gatsby-blog-mdx-c25dab8f5d3d32ee93a8.js\"],\"component---src-templates-post-tsx-content-file-path-blog-posts-build-my-resume-mdx\":[\"/component---src-templates-post-tsx-content-file-path-blog-posts-build-my-resume-mdx-2f7f6c4a5f157ee740ed.js\"],\"component---src-templates-post-tsx-content-file-path-blog-posts-connect-remote-desktop-mdx\":[\"/component---src-templates-post-tsx-content-file-path-blog-posts-connect-remote-desktop-mdx-f7986325497361fdb5a3.js\"],\"component---src-templates-post-tsx-content-file-path-blog-posts-connect-with-pgsql-mdx\":[\"/component---src-templates-post-tsx-content-file-path-blog-posts-connect-with-pgsql-mdx-5e640a3082fe1b36e4d3.js\"],\"component---src-templates-post-tsx-content-file-path-blog-posts-editorconfig-prettier-mdx\":[\"/component---src-templates-post-tsx-content-file-path-blog-posts-editorconfig-prettier-mdx-a0627f47d8cada47c709.js\"],\"component---src-templates-post-tsx-content-file-path-blog-posts-electron-real-time-print-execution-log-mdx\":[\"/component---src-templates-post-tsx-content-file-path-blog-posts-electron-real-time-print-execution-log-mdx-969fa0b8110e403a2ba0.js\"],\"component---src-templates-post-tsx-content-file-path-blog-posts-euler-install-mysql-mdx\":[\"/component---src-templates-post-tsx-content-file-path-blog-posts-euler-install-mysql-mdx-235e7cf1dce691da806e.js\"],\"component---src-templates-post-tsx-content-file-path-blog-posts-github-jsdelivr-hold-image-mdx\":[\"/component---src-templates-post-tsx-content-file-path-blog-posts-github-jsdelivr-hold-image-mdx-2573e68fc174df140f4b.js\"],\"component---src-templates-post-tsx-content-file-path-blog-posts-hello-hexo-world-mdx\":[\"/component---src-templates-post-tsx-content-file-path-blog-posts-hello-hexo-world-mdx-ec073c7276624bf943d4.js\"],\"component---src-templates-post-tsx-content-file-path-blog-posts-hexo-github-actions-ci-cd-mdx\":[\"/component---src-templates-post-tsx-content-file-path-blog-posts-hexo-github-actions-ci-cd-mdx-f5e6d676e57cbef90de8.js\"],\"component---src-templates-post-tsx-content-file-path-blog-posts-iso-iec-ieee-42010-des-mdx\":[\"/component---src-templates-post-tsx-content-file-path-blog-posts-iso-iec-ieee-42010-des-mdx-599c4c7eadcbe47ff292.js\"],\"component---src-templates-post-tsx-content-file-path-blog-posts-js-closure-mdx\":[\"/component---src-templates-post-tsx-content-file-path-blog-posts-js-closure-mdx-c25a3be700815363c2d4.js\"],\"component---src-templates-post-tsx-content-file-path-blog-posts-js-debounce-throttle-mdx\":[\"/component---src-templates-post-tsx-content-file-path-blog-posts-js-debounce-throttle-mdx-5d2581c56908298f1ceb.js\"],\"component---src-templates-post-tsx-content-file-path-blog-posts-js-hoisting-mdx\":[\"/component---src-templates-post-tsx-content-file-path-blog-posts-js-hoisting-mdx-7e22dc4b67db5b74c4c9.js\"],\"component---src-templates-post-tsx-content-file-path-blog-posts-js-use-class-mdx\":[\"/component---src-templates-post-tsx-content-file-path-blog-posts-js-use-class-mdx-4c463d329f5531550591.js\"],\"component---src-templates-post-tsx-content-file-path-blog-posts-js-webworker-settimeout-mdx\":[\"/component---src-templates-post-tsx-content-file-path-blog-posts-js-webworker-settimeout-mdx-ca5c4c8c2bc6eb2a8300.js\"],\"component---src-templates-post-tsx-content-file-path-blog-posts-linux-docker-gcc-update-mdx\":[\"/component---src-templates-post-tsx-content-file-path-blog-posts-linux-docker-gcc-update-mdx-7a9c9f1d03fa31b214e3.js\"],\"component---src-templates-post-tsx-content-file-path-blog-posts-linux-docker-install-grpc-mdx\":[\"/component---src-templates-post-tsx-content-file-path-blog-posts-linux-docker-install-grpc-mdx-992a44e8b2cf28ee4335.js\"],\"component---src-templates-post-tsx-content-file-path-blog-posts-linux-project-v-mdx\":[\"/component---src-templates-post-tsx-content-file-path-blog-posts-linux-project-v-mdx-a920b4ac65c7502eaf74.js\"],\"component---src-templates-post-tsx-content-file-path-blog-posts-lucky-draw-mdx\":[\"/component---src-templates-post-tsx-content-file-path-blog-posts-lucky-draw-mdx-8c01248d676eb6727e49.js\"],\"component---src-templates-post-tsx-content-file-path-blog-posts-nginx-services-mdx\":[\"/component---src-templates-post-tsx-content-file-path-blog-posts-nginx-services-mdx-a21e01e74157cd27ddc4.js\"],\"component---src-templates-post-tsx-content-file-path-blog-posts-nodejs-eslint-prettier-mdx\":[\"/component---src-templates-post-tsx-content-file-path-blog-posts-nodejs-eslint-prettier-mdx-f43dfbbce1302c6bb005.js\"],\"component---src-templates-post-tsx-content-file-path-blog-posts-protobuf-learning-mdx\":[\"/component---src-templates-post-tsx-content-file-path-blog-posts-protobuf-learning-mdx-d565fffdff59d3e2fdcc.js\"],\"component---src-templates-post-tsx-content-file-path-blog-posts-pytorch-install-windows-10-mdx\":[\"/component---src-templates-post-tsx-content-file-path-blog-posts-pytorch-install-windows-10-mdx-a558dfcc81b124e1f96b.js\"],\"component---src-templates-post-tsx-content-file-path-blog-posts-random-get-me-a-picture-mdx\":[\"/component---src-templates-post-tsx-content-file-path-blog-posts-random-get-me-a-picture-mdx-e33fa886af99fca62058.js\"],\"component---src-templates-post-tsx-content-file-path-blog-posts-run-dont-starve-server-mdx\":[\"/component---src-templates-post-tsx-content-file-path-blog-posts-run-dont-starve-server-mdx-1235282df561b5b444fb.js\"],\"component---src-templates-post-tsx-content-file-path-blog-posts-run-mc-server-mdx\":[\"/component---src-templates-post-tsx-content-file-path-blog-posts-run-mc-server-mdx-9839b4430b8cfa4e0579.js\"],\"component---src-templates-post-tsx-content-file-path-blog-posts-start-telegram-bot-mdx\":[\"/component---src-templates-post-tsx-content-file-path-blog-posts-start-telegram-bot-mdx-26f2146c4c2546bf1516.js\"],\"component---src-templates-post-tsx-content-file-path-blog-posts-switch-travis-to-github-workflow-mdx\":[\"/component---src-templates-post-tsx-content-file-path-blog-posts-switch-travis-to-github-workflow-mdx-1f5a93ddfe91ffe1f6d8.js\"],\"component---src-templates-post-tsx-content-file-path-blog-posts-sync-qzone-talks-mdx\":[\"/component---src-templates-post-tsx-content-file-path-blog-posts-sync-qzone-talks-mdx-a656ab739760db00cc28.js\"],\"component---src-templates-post-tsx-content-file-path-blog-posts-tencent-map-api-get-current-location-mdx\":[\"/component---src-templates-post-tsx-content-file-path-blog-posts-tencent-map-api-get-current-location-mdx-444ac4806d6fdf0e288d.js\"],\"component---src-templates-post-tsx-content-file-path-blog-posts-tg-mtproto-one-click-mdx\":[\"/component---src-templates-post-tsx-content-file-path-blog-posts-tg-mtproto-one-click-mdx-5410ecee766eb23e3cbb.js\"],\"component---src-templates-post-tsx-content-file-path-blog-posts-umi-plugin-usemodel-mdx\":[\"/component---src-templates-post-tsx-content-file-path-blog-posts-umi-plugin-usemodel-mdx-f9aedadf5c0d030927d5.js\"],\"component---src-templates-post-tsx-content-file-path-blog-posts-web-font-for-hexo-theme-archer-mdx\":[\"/component---src-templates-post-tsx-content-file-path-blog-posts-web-font-for-hexo-theme-archer-mdx-e148d435fd5b1213b1ca.js\"],\"component---src-templates-post-tsx-content-file-path-blog-posts-website-deployment-docker-nginx-mdx\":[\"/component---src-templates-post-tsx-content-file-path-blog-posts-website-deployment-docker-nginx-mdx-dd053294cb6a5eca04d2.js\"],\"component---src-templates-post-tsx-content-file-path-blog-posts-windows-install-grpc-mdx\":[\"/component---src-templates-post-tsx-content-file-path-blog-posts-windows-install-grpc-mdx-f76c9b27f2eb78c6d0e7.js\"],\"component---src-templates-post-tsx-content-file-path-blog-posts-write-md-parser-mdx\":[\"/component---src-templates-post-tsx-content-file-path-blog-posts-write-md-parser-mdx-618ad5e0c9c8e91cc8c9.js\"],\"component---src-templates-post-tsx-content-file-path-blog-posts-xxx-is-not-a-symbolic-link-mdx\":[\"/component---src-templates-post-tsx-content-file-path-blog-posts-xxx-is-not-a-symbolic-link-mdx-ec0ccb7586205a53547b.js\"]}";
          </script>
        <script>window.___webpackCompilationHash="2fd9ccacc81d703da283";</script><script src="/webpack-runtime-d5e0098e5d29cce9ff6e.js" async></script><script src="/framework-b1d62bf3b340a18edf2f.js" async></script><script src="/c16184b3-3e74c358d62c47dddf30.js" async></script><script src="/2cca2479-5af2f2b649fd0010debb.js" async></script><script src="/app-5463486eff8b3394a611.js" async></script><!-- slice-end id="_gatsby-scripts-1" --></body></html>