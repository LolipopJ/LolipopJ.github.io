"use strict";(self.webpackChunkhomepage=self.webpackChunkhomepage||[]).push([[6198],{2844:function(e,n,t){t.r(n),t.d(n,{Head:function(){return k},default:function(){return f}});var a=t(8453),s=t(6540);function l(e){const n=Object.assign({p:"p",strong:"strong",h2:"h2",ul:"ul",li:"li",blockquote:"blockquote",span:"span",a:"a"},(0,a.R)(),e.components);return s.createElement(s.Fragment,null,s.createElement(n.p,null,"哪位代码人不希望自己的代码总有统一优美的风格，不会因为合作开发项目而杂乱呢？"),"\n",s.createElement(n.p,null,"在最开始写项目代码的时候我就用起了 ESLint 和 Prettier，再装一堆预设的配置，便跑了起来。令人沮丧的是，用 ESLint 修复了代码",s.createElement(n.strong,null,"质量"),"问题，还是会在编译器里看到红色波浪线，提醒还有些代码",s.createElement(n.strong,null,"风格"),"需要修复。直到这一次，我才忽然意识到 ESLint 和 Prettier 其实分工了不同领域，协同使用体验极好。"),"\n",s.createElement(n.p,null,"本文将阐述笔者如何配置 ESLint + Prettier，实现前端项目检查并修复代码质量与格式问题的能力。"),"\n",s.createElement(n.h2,null,"介绍 ESLint 与 Prettier"),"\n",s.createElement(n.p,null,"ESLint 是一个开源的 JavaScript 代码检查工具，Prettier 是一款代码格式工具。它们的功能侧重如下所示："),"\n",s.createElement(n.ul,null,"\n",s.createElement(n.li,null,"ESLint：主要负责代码",s.createElement(n.strong,null,"质量"),"的校验，其次包含部分的",s.createElement(n.strong,null,"风格"),"检验。"),"\n",s.createElement(n.li,null,"Prettier：主要负责代码",s.createElement(n.strong,null,"风格"),"的校验。"),"\n"),"\n",s.createElement(n.p,null,"ESLint 认为代码风格并没有那么重要，因此并未完全解决代码风格问题。"),"\n",s.createElement(n.blockquote,null,"\n",s.createElement(n.p,null,'Rules are "agenda free" - ESLint does not promote any particular coding style.'),"\n"),"\n",s.createElement(n.p,null,"而 Prettier 则认为自己是固执己见的代码格式化工具。"),"\n",s.createElement(n.blockquote,null,"\n",s.createElement(n.p,null,"An opinionated code formatter."),"\n"),"\n",s.createElement(n.p,null,"目前公认的一个最佳实践是结合二者的强项：让 Prettier 专注处理代码格式问题，让 ESLint 专注处理代码质量问题。"),"\n",s.createElement(n.h2,null,"引入 ESLint 与 Prettier"),"\n",s.createElement(n.p,null,"首先，自然是安装 ESLint 和 Prettier 作为项目依赖。"),"\n",s.createElement(n.span,{dangerouslySetInnerHTML:{__html:'<div class="gatsby-highlight" data-language="bash"><pre class="language-bash"><code class="language-bash"><span class="token function">yarn</span> <span class="token function">add</span> <span class="token parameter variable">--dev</span> eslint prettier</code></pre></div>'}}),"\n",s.createElement(n.p,null,"接着，让 ESLint 一并接管 Prettier 的工作，这可以通过以下两个库实现："),"\n",s.createElement(n.ul,null,"\n",s.createElement(n.li,null,s.createElement(n.a,{href:"https://github.com/prettier/eslint-plugin-prettier"},s.createElement(n.span,{dangerouslySetInnerHTML:{__html:'<code class="language-text">eslint-plugin-prettier</code>'}})),"：ESLint 插件，包括了 ESLint 需要检查的一些额外代码格式规则。在幕后，它使用到了 Prettier，相当于将 Prettier 作为 ESLint 的一部分运行。"),"\n",s.createElement(n.li,null,s.createElement(n.a,{href:"https://github.com/prettier/eslint-config-prettier"},s.createElement(n.span,{dangerouslySetInnerHTML:{__html:'<code class="language-text">eslint-config-prettier</code>'}})),"：ESLint 配置，可以关闭 ESLint 里所有不必要或者可能与 Prettier 产生冲突的代码格式规则。"),"\n"),"\n",s.createElement(n.p,null,"在项目里安装它们："),"\n",s.createElement(n.span,{dangerouslySetInnerHTML:{__html:'<div class="gatsby-highlight" data-language="bash"><pre class="language-bash"><code class="language-bash"><span class="token function">yarn</span> <span class="token function">add</span> <span class="token parameter variable">--dev</span> eslint-plugin-prettier eslint-config-prettier</code></pre></div>'}}),"\n",s.createElement(n.p,null,"将 ",s.createElement(n.span,{dangerouslySetInnerHTML:{__html:'<code class="language-text">eslint-plugin-prettier</code>'}})," 的推荐配置 ",s.createElement(n.span,{dangerouslySetInnerHTML:{__html:'<code class="language-text">plugin:prettier/recommended</code>'}})," 放到 ESLint 配置里 ",s.createElement(n.span,{dangerouslySetInnerHTML:{__html:'<code class="language-text">extends</code>'}})," 的最后一项即可，它将自动配置并启用 ",s.createElement(n.span,{dangerouslySetInnerHTML:{__html:'<code class="language-text">eslint-config-prettier</code>'}}),"。如下所示："),"\n",s.createElement(n.span,{dangerouslySetInnerHTML:{__html:'<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js"><span class="token comment">// .eslintrc.js</span>\nmodule<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>\n  <span class="token keyword">extends</span><span class="token operator">:</span> <span class="token punctuation">[</span>\n    <span class="token comment">// ... 您使用的其它 ESLint 拓展</span>\n    <span class="token string">"plugin:prettier/recommended"</span><span class="token punctuation">,</span>\n  <span class="token punctuation">]</span><span class="token punctuation">,</span>\n<span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre></div>'}}),"\n",s.createElement(n.p,null,"对于新版本的 ESLint 配置文件 ",s.createElement(n.span,{dangerouslySetInnerHTML:{__html:'<code class="language-text">eslint.config.js</code>'}}),"，可以像下面这样配置："),"\n",s.createElement(n.span,{dangerouslySetInnerHTML:{__html:'<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js"><span class="token keyword">const</span> eslintPluginPrettierRecommended <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">"eslint-plugin-prettier/recommended"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\nmodule<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">[</span>\n  <span class="token comment">// ... 您使用的其它 ESLint 拓展</span>\n  eslintPluginPrettierRecommended<span class="token punctuation">,</span>\n<span class="token punctuation">]</span><span class="token punctuation">;</span></code></pre></div>'}}),"\n",s.createElement(n.p,null,"参考 Prettier 的官方",s.createElement(n.a,{href:"https://prettier.io/docs/options.html"},"配置文档"),"，您可以自由地配置项目代码的风格。在项目目录创建 ",s.createElement(n.span,{dangerouslySetInnerHTML:{__html:'<code class="language-text">.prettierrc.json</code>'}})," 文件，添加风格配置项如："),"\n",s.createElement(n.span,{dangerouslySetInnerHTML:{__html:'<div class="gatsby-highlight" data-language="json"><pre class="language-json"><code class="language-json"><span class="token punctuation">{</span>\n  <span class="token comment">// 注释只是便于理解，您应当删除 JSON 文件里的注释</span>\n  <span class="token property">"semi"</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token comment">// 句末是否添加分号</span>\n  <span class="token property">"singleQuote"</span><span class="token operator">:</span> <span class="token boolean">true</span> <span class="token comment">// 是否使用单引号（而非双引号）</span>\n<span class="token punctuation">}</span></code></pre></div>'}}),"\n",s.createElement(n.p,null,"当然，笔者通常保持 Prettier 的默认风格，不单独引入配置文件。"),"\n",s.createElement(n.h2,null,"现在就格式化代码吧"),"\n",s.createElement(n.p,null,"修改 ",s.createElement(n.span,{dangerouslySetInnerHTML:{__html:'<code class="language-text">package.json</code>'}})," 文件，添加脚本："),"\n",s.createElement(n.span,{dangerouslySetInnerHTML:{__html:'<div class="gatsby-highlight" data-language="json"><pre class="language-json"><code class="language-json"><span class="token comment">// package.json</span>\n<span class="token punctuation">{</span>\n  <span class="token property">"scripts"</span><span class="token operator">:</span> <span class="token punctuation">{</span>\n    <span class="token property">"lint"</span><span class="token operator">:</span> <span class="token string">"eslint ."</span>\n  <span class="token punctuation">}</span>\n<span class="token punctuation">}</span></code></pre></div>'}}),"\n",s.createElement(n.p,null,"根据上面的配置，可以在项目根目录下执行如下脚本："),"\n",s.createElement(n.span,{dangerouslySetInnerHTML:{__html:'<div class="gatsby-highlight" data-language="bash"><pre class="language-bash"><code class="language-bash"><span class="token comment"># 检查代码质量问题</span>\n<span class="token function">yarn</span> lint\n\n<span class="token comment"># 检查并修复代码质量问题</span>\n<span class="token function">yarn</span> lint <span class="token parameter variable">--fix</span></code></pre></div>'}}),"\n",s.createElement(n.p,null,"由于我们将 Prettier 作为了 ESLint 的插件运行，所以无需手动执行 Prettier 的格式化命令了。"),"\n",s.createElement(n.p,null,"在 VSCode 里，也应当将 ESLint 作为默认的格式化工具。如果正确地安装并启用了 VSCode 的 ESLint 拓展，编辑器就能正确的高亮 ESLint 与 Prettier 检查出来的问题了。"),"\n",s.createElement(n.p,null,"此外，VSCode 还可以设置",s.createElement(n.strong,null,"保存时自动修复代码问题"),"，如下所示。这样执行 ",s.createElement(n.span,{dangerouslySetInnerHTML:{__html:'<code class="language-text">Ctrl + S</code>'}})," 保存时会自动格式化代码文件。"),"\n",s.createElement(n.span,{dangerouslySetInnerHTML:{__html:'<div class="gatsby-highlight" data-language="json"><pre class="language-json"><code class="language-json"><span class="token comment">// settings.json</span>\n<span class="token property">"editor.codeActionsOnSave"</span><span class="token operator">:</span> <span class="token punctuation">{</span>\n  <span class="token property">"source.fixAll.eslint"</span><span class="token operator">:</span> <span class="token boolean">true</span>\n<span class="token punctuation">}</span><span class="token punctuation">,</span></code></pre></div>'}}),"\n",s.createElement(n.h2,null,"参考资料"),"\n",s.createElement(n.ul,null,"\n",s.createElement(n.li,null,s.createElement(n.a,{href:"https://stackoverflow.com/questions/44690308/whats-the-difference-between-prettier-eslint-eslint-plugin-prettier-and-eslint"},"What's the difference between prettier-eslint, eslint-plugin-prettier and eslint-config-prettier?")," - stackoverflow"),"\n",s.createElement(n.li,null,s.createElement(n.a,{href:"https://github.com/prettier/prettier-eslint-cli/issues/208#issuecomment-673631308"},"Error: 'basePath' should be an absolute path")," - mathiaswillburger - 2020.08.14"),"\n",s.createElement(n.li,null,s.createElement(n.a,{href:"https://zhuanlan.zhihu.com/p/80574300"},"搞懂 ESLint 和 Prettier")," - 乃乎 - 2019.08.31"),"\n",s.createElement(n.li,null,s.createElement(n.a,{href:"https://www.jianshu.com/p/dd07cca0a48e"},"ESLint+Prettier 代码规范实践")," - Bernie 维 - 2019.06.04"),"\n"))}var r=function(e){void 0===e&&(e={});const{wrapper:n}=Object.assign({},(0,a.R)(),e.components);return n?s.createElement(n,e,s.createElement(l,e)):l(e)},c=t(197),o=t(4353),p=t.n(o),i=t(4794),u=t(6947),m=t(4017),g=t(1042),d=t(1038);const E={a:e=>{let{href:n="",children:t}=e;const a=!(null!=n&&n.startsWith("#")),l=a?n:`#${encodeURIComponent(n.slice(1))}`;return s.createElement("a",{href:l,target:a?"_blank":void 0,rel:"noreferrer"},t)},img:e=>{const{alt:n="The author is too lazy to give an alt",src:t,...a}=e;return s.createElement("a",{href:t,"data-fancybox":"gallery","data-caption":n},s.createElement("img",Object.assign({src:t,alt:n},a)))},Card:u.A,Link:i.Link},h=e=>{let{children:n,data:t}=e;const{mdx:{fields:{isDraft:l},frontmatter:{title:r,date:o,updated:i,categories:u,tags:g,timeliness:h}}}=t,k=s.useRef(null),f=p()(o),b=i?p()(i):f,S=p()().diff(b,"days");return s.useEffect((()=>{var e;const n=null===(e=k.current)||void 0===e?void 0:e.querySelectorAll("a.gatsby-resp-image-link");return null==n||n.forEach((e=>{const n=e.children.item(1);e.setAttribute("data-fancybox","gallery"),e.setAttribute("data-caption",n.alt)})),c.lX.bind("[data-fancybox]"),()=>c.lX.unbind("[data-fancybox]")}),[]),s.createElement("div",{className:"mx-auto flex max-w-xl flex-col gap-y-12"},s.createElement("div",{className:"flex flex-col gap-4"},(null==u?void 0:u.length)&&s.createElement(m.A,{name:u[0],className:"item-selectable"}),s.createElement("h1",{className:"text-3xl font-bold"},r),s.createElement("div",{className:"item-secondary flex flex-col gap-2 lg:flex-row"},o&&s.createElement("span",{title:`首次发布于：${f.toString()}\n最后更新于：${b.toString()}`},f.format("MM 月 DD 日 YYYY 年")),(null==g?void 0:g.length)&&s.createElement("div",{className:"flex flex-1 flex-wrap gap-2 lg:before:content-['•']"},g.map((e=>s.createElement(d.A,{key:e,name:e,className:"item-secondary item-selectable"})))))),s.createElement("article",{ref:k,className:"heti post-entry"},l&&s.createElement("blockquote",{className:"!border-red-400"},"这是一篇",s.createElement("strong",null,"未正式发布"),"的博客，内容可能尚未撰写完全或存在一些纰漏，建议您仔细评估信息的有效性。"),!1!==h&&S>365&&s.createElement("blockquote",{className:"!border-orange-400"},"这是一篇",s.createElement("strong",null,"最后更新于 ",S," 天前"),"的博客，内容可能随着时间的推移而变得不再适用，建议您仔细评估信息的有效性。"),s.createElement(a.x,{components:E},n)))},k=e=>{let{data:n}=e;return s.createElement(g.A,{title:String(n.mdx.frontmatter.title)})};function f(e){return s.createElement(h,e,s.createElement(r,e))}}}]);
//# sourceMappingURL=component---src-templates-post-tsx-content-file-path-blog-posts-nodejs-eslint-prettier-mdx-d111a5fcb7cc08aea7b7.js.map