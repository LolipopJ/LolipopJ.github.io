"use strict";(self.webpackChunkhomepage=self.webpackChunkhomepage||[]).push([[417],{4943:function(e,n,t){t.r(n),t.d(n,{Head:function(){return E},default:function(){return y}});var a=t(8453),s=t(6540);function l(e){const n=Object.assign({p:"p",span:"span",h2:"h2",strong:"strong"},(0,a.R)(),e.components);return s.createElement(s.Fragment,null,s.createElement(n.p,null,"项目中使用了 AntD 4.x 的 ",s.createElement(n.span,{dangerouslySetInnerHTML:{__html:'<code class="language-text">&lt;DatePicker /></code>'}})," 组件，开发环境显示正常，生产环境显示乱码，如下图所示："),"\n",s.createElement(n.span,{dangerouslySetInnerHTML:{__html:'<span\n      class="gatsby-resp-image-wrapper"\n      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 624px; "\n    >\n      <a\n    class="gatsby-resp-image-link"\n    href="/static/49063711695b4a657ebb4f9dc8b6de5e/adc48/error.png"\n    style="display: block"\n    target="_blank"\n    rel="noopener"\n  >\n    <span\n    class="gatsby-resp-image-background-image"\n    style="padding-bottom: 88.46153846153847%; position: relative; bottom: 0; left: 0; background-image: url(\'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAASCAIAAADUsmlHAAAACXBIWXMAAAsTAAALEwEAmpwYAAAByUlEQVR42n1TyVLCQBCdv/WoR3+AKrYCivJmKah/4cGjnyEoBAJkmS2BrPgmDUMQyq6meTTd06/fJGw2m/m+nyS7JEnSNM2yNM/zoijKsjiz2u/8aGw6/XHddchlGAouFJdKKk2uVKSqKI3rk0stlCljoZAbz/eDcLPxuZA6iqMo1vrQdujXUVTlj76VUnlewDjHQCnIpQoCvsZhAc5UxoVxFMBxxB9naZpUG8GK/X6PEVBBCAF83DSHFrvdrrwwBp2oGQJkmZEKbRXOEMuqGzVa6+zCGD7b7Xa1WiHSZNd1CcdxTBg11GwPRcSJjL7CMAQ3zEFpdXMJMGIQBNX9nZqpk5KMemhDumHCtAswImrAon7PBBgQqM7nc6KKCY7joJQw5e1kMjv/QJtzThSgKjDRJnxJ+9Rcp22pWoZE+z+1rapE1WKss1wuiTawXdXaiTZRRSkUtrRJbdj1yVfVLo/vkFUbT3h9W7otVv2hHGeBZxsp3/MmX5ON50Eck1+YPCiAi2072xlj4tisZObnmZJGYeISRxpg8u20BuO6kIed3z8+G53H7vC11R81e8/twag7fEFs9p6QaQ/G/Ye3u/vOzW2Dnvm6/QKBoASMT6rzcAAAAABJRU5ErkJggg==\'); background-size: cover; display: block;"\n  ></span>\n  <img\n        class="gatsby-resp-image-image"\n        alt="error"\n        title=""\n        src="/static/49063711695b4a657ebb4f9dc8b6de5e/39c09/error.png"\n        srcset="/static/49063711695b4a657ebb4f9dc8b6de5e/680fe/error.png 156w,\n/static/49063711695b4a657ebb4f9dc8b6de5e/17474/error.png 312w,\n/static/49063711695b4a657ebb4f9dc8b6de5e/39c09/error.png 624w,\n/static/49063711695b4a657ebb4f9dc8b6de5e/6d2da/error.png 936w,\n/static/49063711695b4a657ebb4f9dc8b6de5e/adc48/error.png 979w"\n        sizes="(max-width: 624px) 100vw, 624px"\n        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"\n        loading="lazy"\n        decoding="async"\n      />\n  </a>\n    </span>'}}),"\n",s.createElement(n.h2,null,"问题原因"),"\n",s.createElement(n.p,null,s.createElement(n.span,{dangerouslySetInnerHTML:{__html:'<code class="language-text">&lt;DatePicker /></code>'}})," 组件底层的国际化既由 AntD 提供的 ",s.createElement(n.span,{dangerouslySetInnerHTML:{__html:'<code class="language-text">&lt;ConfigProvider /></code>'}})," 控制（如上图的“年”，显示正常），又由 Moment 控制（如上图的“月”，显示乱码）。"),"\n",s.createElement(n.p,null,"经查询，当我们以 ISO8859-1 方式读取 UTF-8 编码的中文时，会出现如“ç”±æœˆè¦�å¥½å¥½å­¦ä¹ å¤©å¤©å�‘ä¸Š”这样的符号型乱码，正如上图所示。"),"\n",s.createElement(n.p,null,"因此产生问题的关键在于，",s.createElement(n.strong,null,"为何浏览器没有正确地以 UTF-8 格式读取 Moment 提供的中文语言包文本。")),"\n",s.createElement(n.p,null,"经排查，发现在访问生产环境时，服务端返回的 HTML 文档设置了编码为 ISO8859-1："),"\n",s.createElement(n.span,{dangerouslySetInnerHTML:{__html:'<span\n      class="gatsby-resp-image-wrapper"\n      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 624px; "\n    >\n      <a\n    class="gatsby-resp-image-link"\n    href="/static/042daec5987582b5812a734ce319b106/7b1dc/response-content-type.png"\n    style="display: block"\n    target="_blank"\n    rel="noopener"\n  >\n    <span\n    class="gatsby-resp-image-background-image"\n    style="padding-bottom: 71.15384615384615%; position: relative; bottom: 0; left: 0; background-image: url(\'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAOCAIAAACgpqunAAAACXBIWXMAAAsTAAALEwEAmpwYAAAB7UlEQVR42l1Ta4+bMBDkl/SaAAkQAkl4GRuDDTiQS+4u15d0aiv1pPveqlL/f8dxiqJKo5WDd2fGuxtLturzlxfK6rm9cFzPwHaWecEoEwWpCOW0ErxuSanPQFXLJCXIsYTsz8+fWNXgx21xo/okI7O5C9LbK/ffAbDqpoUyit/dzZF6LXaXlRK8aYNVFEbbxTLQLBci57YYtn+8vo2HU1EyGJuU4zhlXPKma6RKsnIVxlG8W0fbyYW2jU+QhT5YEN2Fr+F6u7QA0rzcJnmalVlO8f40p9q5yVn4FuNivH+EiOeHMAkuo0BKJloFz9C8IMKt0Z9gwaraHzo1hmtY8pbeCsAjSckBHDx/peHpaG4nWAVh++G+7YdGdMY2HjO3XcqaKE7uZq6zCGw3sE109e0EKy9or0bZKRT7wXpqRskaSrkcnp++/3789uvh688Pr3/E4QUWYPDabV7Ligt4wJMgi4Mp1svQyFru+8N5OH2U6kH0R3U4b3fZ1HA95+PpCS8HBYjQc+hjpNgw2Q2IteiwUpgIPGLyGB5aZeotfB3GY7xJ0OEw2kD8up6Etf0Iovczx6SaaBKuyiXlXT8gQhkwSdik7KKcZgTjAYV9WdL/oLu92aaXBdZ7i9kAoMeGEFqDAiuAvwG+mKtb/AWMK6MKSnFbawAAAABJRU5ErkJggg==\'); background-size: cover; display: block;"\n  ></span>\n  <img\n        class="gatsby-resp-image-image"\n        alt="response-content-type"\n        title=""\n        src="/static/042daec5987582b5812a734ce319b106/39c09/response-content-type.png"\n        srcset="/static/042daec5987582b5812a734ce319b106/680fe/response-content-type.png 156w,\n/static/042daec5987582b5812a734ce319b106/17474/response-content-type.png 312w,\n/static/042daec5987582b5812a734ce319b106/39c09/response-content-type.png 624w,\n/static/042daec5987582b5812a734ce319b106/6d2da/response-content-type.png 936w,\n/static/042daec5987582b5812a734ce319b106/7b1dc/response-content-type.png 956w"\n        sizes="(max-width: 624px) 100vw, 624px"\n        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"\n        loading="lazy"\n        decoding="async"\n      />\n  </a>\n    </span>'}}),"\n",s.createElement(n.p,null,"一切便水落石出。"),"\n",s.createElement(n.h2,null,"如何解决"),"\n",s.createElement(n.p,null,"最好的解决方案是联系服务端同学，修改 ",s.createElement(n.span,{dangerouslySetInnerHTML:{__html:'<code class="language-text">Content-Type=text/html;charset=UTF-8</code>'}}),"。"),"\n",s.createElement(n.p,null,"在这个项目中，使用了 CDN 的方式引入 Moment，因此可以采用的一个临时解决方案为强制指定编码，例如："),"\n",s.createElement(n.span,{dangerouslySetInnerHTML:{__html:'<div class="gatsby-highlight" data-language="html"><pre class="language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span>\n  <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>https://gw.alipayobjects.com/os/lib/??moment/2.29.1/moment.js,moment/2.29.1/locale/zh-cn.js<span class="token punctuation">"</span></span>\n  <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>utf-8<span class="token punctuation">"</span></span>\n<span class="token punctuation">></span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span></code></pre></div>'}}))}var c=function(e){void 0===e&&(e={});const{wrapper:n}=Object.assign({},(0,a.R)(),e.components);return n?s.createElement(n,e,s.createElement(l,e)):l(e)},r=t(197),o=t(4353),p=t.n(o),i=t(4810),g=t(6947),m=t(4017),d=t(1042),u=t(1038);const b={a:e=>{let{href:n="",children:t}=e;const a=!(null!=n&&n.startsWith("#")),l=a?n:`#${encodeURIComponent(n.slice(1))}`;return s.createElement("a",{href:l,target:a?"_blank":void 0,rel:"noreferrer"},t)},img:e=>{const{alt:n="The author is too lazy to give an alt",src:t,...a}=e;return s.createElement("a",{href:t,"data-fancybox":"gallery","data-caption":n},s.createElement("img",Object.assign({src:t,alt:n},a)))},Card:g.A,Link:i.N_},A=e=>{let{children:n,data:t}=e;const{mdx:{frontmatter:{title:l,date:c,updated:o,categories:i,tags:g,timeliness:d=!0}}}=t,A=s.useRef(null),E=p()(c),y=o?p()(o):E,f=p()().diff(y,"days");return s.useEffect((()=>{var e;const n=null===(e=A.current)||void 0===e?void 0:e.querySelectorAll("a.gatsby-resp-image-link");return null==n||n.forEach((e=>{const n=e.children.item(1);e.setAttribute("data-fancybox","gallery"),e.setAttribute("data-caption",n.alt)})),r.lX.bind("[data-fancybox]"),()=>r.lX.unbind("[data-fancybox]")}),[]),s.createElement("div",{className:"mx-auto flex max-w-xl flex-col gap-y-12"},s.createElement("div",{className:"flex flex-col gap-4"},(null==i?void 0:i.length)&&s.createElement(m.A,{name:i[0],className:"item-selectable"}),s.createElement("h1",{className:"text-3xl font-bold"},l),s.createElement("div",{className:"item-secondary flex flex-col gap-2 lg:flex-row"},c&&s.createElement("span",{title:`首次发布于：${E.toString()}\n最后更新于：${y.toString()}`},E.format("MM 月 DD 日 YYYY 年")),(null==g?void 0:g.length)&&s.createElement("div",{className:"flex flex-1 flex-wrap gap-2 lg:before:content-['•']"},g.map((e=>s.createElement(u.A,{key:e,name:e,className:"item-secondary item-selectable"})))))),s.createElement("article",{ref:A,className:"heti post-entry"},d&&f>365&&s.createElement("blockquote",{className:"border-l-4 border-orange-400"},"这是一篇",s.createElement("strong",null,"最后更新于 ",f," 天前"),"的博客，内容可能随着时间的推移而变得不再适用，建议您仔细评估信息的有效性。"),s.createElement(a.x,{components:b},n)))},E=e=>{let{data:n}=e;return s.createElement(d.A,{title:String(n.mdx.frontmatter.title)})};function y(e){return s.createElement(A,e,s.createElement(c,e))}}}]);
//# sourceMappingURL=component---src-templates-post-tsx-content-file-path-blog-posts-antd-comp-garbled-characters-mdx-8e8ba3d2391ed7d010e5.js.map